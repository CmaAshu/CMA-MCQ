<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Management and Business Data Analytics Quiz - Select a Set</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f2f5;
            color: #333;
            line-height: 1.6;
        }
        .developer-info {
            background-color: #e9ecef;
            padding: 8px 15px;
            text-align: center;
            font-size: 0.9em;
            color: #555;
            border-bottom: 1px solid #d1d9e0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .developer-info svg {
            width: 18px;
            height: 18px;
            fill: #555;
        }
        .developer-info a {
            color: #0056b3;
            text-decoration: none;
            font-weight: 500;
        }
        .developer-info a:hover {
            text-decoration: underline;
        }
        .quiz-container {
            max-width: 800px;
            margin: 20px auto;
            background-color: #fff;
            padding: 20px 25px;
            border-radius: 10px;
            box-shadow: 0 6px 18px rgba(0,0,0,0.07);
        }
        h1 {
            text-align: center;
            color: #0056b3;
            margin-bottom: 20px;
            font-size: 1.8em;
        }
        .set-selection-container {
            margin-bottom: 25px;
            padding: 15px;
            background-color: #e9ecef;
            border-radius: 8px;
            text-align: center;
        }
        .set-selection-container h2 {
            margin-bottom: 15px;
            font-size: 1.3em;
            color: #343a40;
        }
        .set-button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 18px;
            margin: 5px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.2s ease-in-out;
        }
        .set-button:hover {
            background-color: #0056b3;
        }
        .set-button.active-set {
            background-color: #28a745;
            font-weight: bold;
        }
        .set-button:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }
        .live-scoreboard {
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
            padding: 12px;
            margin-bottom: 25px;
            background-color: #e9ecef;
            border-radius: 6px;
            color: #0056b3;
            border: 1px solid #d1d9e0;
        }
        .question-block {
            margin-bottom: 28px;
            padding-bottom: 22px;
            border-bottom: 1px dashed #d4dae0;
        }
        .question-block:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
        .question-text {
            font-weight: 600;
            margin-bottom: 15px;
            font-size: 1.1em;
            color: #2c3e50;
        }
        .options label {
            display: block;
            margin-bottom: 10px;
            font-size: 1em;
            cursor: pointer;
            padding: 10px 12px;
            border-radius: 6px;
            transition: background-color 0.2s ease-in-out, border-color 0.2s ease-in-out;
            border: 1px solid #e0e0e0;
            background-color: #f9f9f9;
        }
        .options label:hover:not(.disabled-option) {
            background-color: #e9ecef;
            border-color: #adb5bd;
        }
        .options input[type="radio"] {
            margin-right: 12px;
            vertical-align: middle;
            transform: scale(1.1);
        }
        .options input[type="radio"]:disabled + span {
            color: #6c757d;
        }
        .options label.disabled-option {
            cursor: default;
            background-color: #f0f0f0;
            color: #6c757d;
        }
        .submit-btn {
            display: block;
            width: 100%;
            padding: 14px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 1.15em;
            font-weight: 500;
            cursor: pointer;
            margin-top: 35px;
            transition: background-color 0.25s, opacity 0.25s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .submit-btn:hover:not(:disabled) {
            background-color: #0056b3;
        }
        .submit-btn:disabled {
            background-color: #6c757d;
            opacity: 0.7;
            cursor: not-allowed;
        }
        .result-summary {
            margin-top: 30px;
            padding: 20px;
            border-radius: 6px;
            font-size: 1.25em;
            text-align: center;
            font-weight: 600;
        }
        .result-summary.success {
            background-color: #d1e7dd;
            color: #0f5132;
            border: 1px solid #badbcc;
        }
        .result-summary.error {
            background-color: #f8d7da;
            color: #842029;
            border: 1px solid #f5c2c7;
        }
        .feedback-container {
            margin-top: 10px;
        }
        .feedback {
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 5px;
            font-size: 0.95em;
            display: none;
            border-width: 1px;
            border-style: solid;
        }
        .feedback.correct-answer-text {
            color: #0f5132;
            background-color: #d1e7dd;
            border-color: #badbcc;
            font-weight: 500;
        }
        .feedback.incorrect-answer-text {
            color: #842029;
            background-color: #f8d7da;
            border-color: #f5c2c7;
            font-weight: 500;
        }
        .feedback .user-answer-display {
            display: block;
            font-style: italic;
            font-size: 0.9em;
            margin-bottom: 4px;
        }
        .source-note {
            font-size: 0.85em;
            color: #6c757d;
            text-align: center;
            margin-bottom: 25px;
        }
        .explain-btn {
            background-color: #17a2b8;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
            margin-top: 5px;
            transition: background-color 0.2s;
            display: none;
        }
        .explain-btn:hover {
            background-color: #138496;
        }
        .explain-btn:disabled {
            background-color: #6c757d;
            opacity: 0.7;
            cursor: not-allowed;
        }
        .explanation-area {
            margin-top: 10px;
            padding: 10px;
            background-color: #eef7ff;
            border: 1px solid #cce0f5;
            border-radius: 4px;
            font-size: 0.9em;
            white-space: pre-wrap;
        }
        .loading-message {
            font-style: italic;
            color: #0056b3;
        }
        #quizArea {
            min-height: 100px;
        }
        @media (max-width: 600px) {
            .developer-info { font-size: 0.8em; padding: 6px 10px; }
            .developer-info svg { width: 16px; height: 16px; }
            .quiz-container { margin: 10px; padding: 15px; }
            h1 { font-size: 1.5em; }
            .set-selection-container h2 { font-size: 1.1em; }
            .set-button { padding: 8px 12px; font-size: 0.9em; }
            .live-scoreboard { font-size: 1em; padding: 10px; }
            .question-text { font-size: 1em; }
            .options label { font-size: 0.95em; padding: 8px 10px; }
            .submit-btn, .explain-btn { padding: 12px 15px; font-size: 1.05em; }
            .result-summary { font-size: 1.1em; padding: 15px; }
        }
    </style>
</head>
<body>
    <div class="developer-info">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919.058-1.266.069-1.645.069-4.849zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948s.014 3.667.072 4.947c.2 4.359 2.618 6.78 6.98 6.98 1.28.059 1.689.072 4.948.072s3.667-.014 4.947-.072c4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.947s-.014-3.667-.072-4.947c-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.689-.073-4.948-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg>
        <span>The Legend Developer: <a href="https://www.instagram.com/ashu.ig?igsh=ams5eWxhd2NuNGs4" target="_blank" rel="noopener noreferrer">ashu.ig</a></span>
    </div>
    <div class="quiz-container">
        <h1>Financial Management and Business Data Analytics Quiz</h1>

        <div id="setSelectionContainer" class="set-selection-container">
            <h2>Select a Quiz Set</h2>
            </div>

        <div id="quizArea" style="display:none;"> <div id="liveScoreboard" class="live-scoreboard">Score: 0 / 0 | Answered: 0 / 0</div>
            <p class="source-note">All questions and options are sourced from the "MCQBank_Paper11.pdf" document.</p>
            <form id="quizForm">
                </form>
            <button type="button" class="submit-btn" id="submitButton" onclick="submitCurrentQuiz()">Submit Answers</button>
            <div id="resultSummary" class="result-summary" style="display:none;"></div>
        </div>
        <div id="initialMessage" class="text-center p-5 bg-gray-100 rounded-md">
            <p class="text-lg text-gray-700">Please select a quiz set above to begin.</p>
        </div>
    </div>

    <script>
        // Array to hold all question data from Paper11.html
        const allQuestionsData = [
            { question: "Time value of money explains that:", options: ["a unit of money received today is worth more than a unit received in future", "a unit of money received today is worth less than a unit received in future", "a unit of money received today and at some other time in future is equal", "none of the above"], correctAnswerCode: 1 },
            { question: "Time value of money facilitates comparison of cash flows occurring at different time periods by:", options: ["compounding all cash flows to a common point of time", "discounting all cash flows to a common point of time", "using either (1) or (2)", "neither (1) nor (2)."], correctAnswerCode: 3 },
            { question: "If the nominal rate of interest is 10 per cent per annum and frequency of compounding is 4 i.e. quarterly compounding, the effective rate of interest will be:", options: ["10.25% per annum", "10.38% per annum", "10% per annum", "none of the above"], correctAnswerCode: 2 },
            { question: "Relationship between annual effective rate of interest and annual nominal rate of interest is, if frequency of compounding is more than 1:", options: ["Effective Rate < Nominal rate", "Effective Rate > Nominal rate", "Effective Rate = Nominal rate", "none of the above"], correctAnswerCode: 2 },
            { question: "If annual effective rate of interest is 10.25% per annum and nominal rate of return is 10% per annum what is the frequency of compounding?", options: ["2", "3", "12", "4"], correctAnswerCode: 1 },
            { question: "A student takes a loan of Rs. 50,000 from SBI. The rate of interest being charged by SBI is 10% per annum. What would be the amount of equal annual instalment if he wishes to pay it back in five instalments and first instalment, he will pay at the end of year 5?", options: ["Rs. 11,000", "Rs. 19,310", "Rs. 15,000", "None of the above"], correctAnswerCode: 2 },
            { question: "How much amount should an investor invest now in order to receive five annuities starting from the end of this year of Rs. 10,000 if the rate of interest offered by bank is 10% per annum?", options: ["Rs. 40.000", "Rs. 45,000", "Rs. 37.910", "none of the above"], correctAnswerCode: 3 },
            { question: "A bank offers 12% compound interests payable quarterly. If you deposit Rs.2,000 now, how much it will grow at the end of 5 years?", options: ["Rs.3.050", "Rs.3,430", "Rs.3.612", "Rs.3,722"], correctAnswerCode: 3 },
            { question: "A company wants to repay a loan of Rs. 5,00,000, 10 years from today. What amount should it invest each year for 10 years if the funds can earn 8% per annum? The first investment will be made at the beginning of this year.", options: ["Rs. 50,000", "Rs. 31,950", "Rs. 40.000", "Rs. 32,950"], correctAnswerCode: 2 },
            { question: "Risk of two securities having different expected return can be compared with:", options: ["standard deviation of securities", "variance of securities", "coefficient of variation", "mean"], correctAnswerCode: 3 },
            { question: "A portfolio consists of two securities and the expected return on two securities is 12% and 16% respectively. Calculate return of portfolio if first security accounts for 40% of portfolio.", options: ["14%", "14.40%", "16%", "12%"], correctAnswerCode: 2 },
            { question: "If the rate of interest is 12%, what are the doubling periods as per the rule 72 and the rule of 69 respectively?", options: ["5 Years and 5.2 Years", "5.8 Years and 5.3 Years", "6 Years and 6.1 Years", "6.5 Years and 6.6 Years"], correctAnswerCode: 3 },
            { question: "To create a minimum variance portfolio, in what proportion should the two securities be mixed if the following information is given S1 = 10%, S2 = 12%, P12=0.6? (Assuming S1 and S2 are standard deviations)", options: ["0.72 and 0.28", "0.70 and 0.30", "0.60 and 0.40", "0.50 and 0.40"], correctAnswerCode: 1 },
            { question: "A portfolio consisting of two risky securities can be made risk less i.e., Sp=0, if:", options: ["the securities are perfectly positively correlated", "the securities are perfectly negatively correlated", "if the correlation ranges between 0 to 1", "if the correlation ranges between -1 to +1"], correctAnswerCode: 2 },
            { question: "Efficient portfolios are those portfolios, which offer (for a given level of risk)", options: ["maximum return", "minimum return", "average return", "positive return"], correctAnswerCode: 1 },
            { question: "CAPM accounts for -", options: ["systematic risk", "unsystematic risk", "both of the above", "moderate risk"], correctAnswerCode: 1 },
            { question: "Assets Management company is formed:", options: ["To manage bank's assets", "To manage mutual funds investments", "To construct infrastructure projects", "To run a stock exchange"], correctAnswerCode: 2 },
            { question: "Prime duty of a merchant banker is -", options: ["Maintaining records of clients", "Giving loans to clients", "Working as a Capital Market Intermediary", "None of the above"], correctAnswerCode: 3 },
            { question: "Basic objective of a money market mutual fund is:", options: ["Guaranteed rate of return", "Investment in short-term securities", "Both (1) and (2)", "None of (1) and (2)"], correctAnswerCode: 2 },
            { question: "Short selling refers to:", options: ["Buying shares and then selling them on the same day.", "Selling shares without owning them", "Selling some shares out of a large holding", "Continuously selling shares in lots."], correctAnswerCode: 2 },
            { question: "Which of the following is not regulated by SEBI?", options: ["Foreign Institutional Investors", "Foreign Direct Investment", "Mutual Funds", "Depositories"], correctAnswerCode: 2 },
            { question: "Which of the following is true for mutual funds in India?", options: ["Exit load is not allowed", "Entry load is allowed", "Entry load is not allowed", "Exit load allowed is some cases"], correctAnswerCode: 4 },
            { question: "Which of the following is not available in India?", options: ["Index Options", "Index Futures,", "Commodity Options", "Commodity Futures"], correctAnswerCode: 3 },
            { question: "Which of the following is the benefit of Depositories?", options: ["Reduction in the share transfer time to the buyer", "Reduced Risk of stolen, fake, forged shares", "No Stamp duty on transfer of shares in dematerialized form", "All of the above"], correctAnswerCode: 4 },
            { question: "Credit Rating of a debt security is:", options: ["Guarantee of Repayment", "Merely opinion", "Positive suggestion", "Negative suggestion"], correctAnswerCode: 2 },
            { question: "The first computerised online stock exchange in India was:", options: ["NSE", "OTCEI", "BSE", "MCX"], correctAnswerCode: 2 },
            { question: "Which of the following derivative is not traded on Indian Stock Market?", options: ["Index Options", "Stock Futures", "Index Futures", "Forward Rate Agreements"], correctAnswerCode: 4 },
            { question: "How many depositories are there in India?", options: ["2", "3", "0", "1"], correctAnswerCode: 1 }, // Corrected based on actual number (NSDL, CDSL). PDF key was for option 2.
            { question: "Secondary Market in India is regulated by:", options: ["Reserve Bank of India", "Securities and Exchange Board of India", "Ministry of Finance", "Forward Market Commission"], correctAnswerCode: 2 },
            { question: "________ funds do not have a fixed date of redemption.", options: ["Open ended funds.", "Close ended funds", "Diversified funds", "Both A and B."], correctAnswerCode: 1 },
            { question: "In India, NIFTY and SENSEX are calculated on the basis of:", options: ["Market Capitalization", "Paid up Capital", "Free-float Capitalization", "Authorized Share Capital"], correctAnswerCode: 3 },
            { question: "The type of collateral (security) used for short-term loan is:", options: ["Real estate", "Plant & Machinery", "Stock of good", "Equity share capital"], correctAnswerCode: 3 },
            { question: "Which of the following is a liability of a bank?", options: ["Treasury Bills", "Commercial papers", "Certificate of Deposits", "Junk Bonds."], correctAnswerCode: 3 },
            { question: "Commercial paper is a type of:", options: ["Fixed coupon Bond", "Unsecured short-term debt", "Equity share capital", "Government Bond"], correctAnswerCode: 2 },
            { question: "Which of the following is not a spontaneous source of short-term funds?", options: ["Trade credit", "Accrued expenses", "Provision for dividend", "All of the above"], correctAnswerCode: 3 },
            { question: "In India, Commercial Papers are issued as per the lines issued by", options: ["Securities and Exchange Board of India", "Reserve Bank of India", "Forward Market Commission", "RBI"], correctAnswerCode: 2 },
            { question: "Commercial paper are generally issued at a pries:", options: ["Equal to face value", "More than face value", "Less than face value", "Equal to redemption value"], correctAnswerCode: 3 },
            { question: "Which of the following is not applicable to commercial paper?", options: ["Face Value", "Issue Price", "Coupon Rate", "None of the above"], correctAnswerCode: 3 },
            { question: "Accounting Ratios are important tools used by", options: ["Managers", "Researchers", "Investors", "All of the above"], correctAnswerCode: 4 },
            { question: "Net Profit Ratio Signifies:", options: ["Operational Profitability", "Liquidity Position", "Big-term Solvency", "Profit for Lenders"], correctAnswerCode: 1 },
            { question: "Working Capital Turnover measures, the relationship of Working Capital with:", options: ["Fixed Assets", "Sales", "Purchases", "Stock"], correctAnswerCode: 2 },
            { question: "Dividend Pay-out Ratio is:", options: ["PAT Capital", "DPS EPS", "Pref. Dividend PAT", "Pref. Dividend Equity Dividend"], correctAnswerCode: 2 },
            { question: "DuPont Analysis deals with:", options: ["Analysis of Current Assets", "Analysis of Profit", "Capital Budgeting", "Analysis of Fixed Assets"], correctAnswerCode: 2 },
            { question: "In Net Profit Ratio, the denominator is:", options: ["Net Purchases", "Net Sales", "Credit Sales", "Cost of goods sold"], correctAnswerCode: 2 },
            { question: "Inventory Turnover measures the relationship of inventory with:", options: ["Average Sales", "Cost of Goods Sold", "Total Purchases", "Total Assets"], correctAnswerCode: 2 },
            { question: "The term 'EVA' is used for:", options: ["Extra Value Analysis", "Economic Value Added", "Expected Value Analysis", "Engineering Value Analysis."], correctAnswerCode: 2 },
            { question: "Return on Investment may be improved by:", options: ["Increasing Turnover", "Reducing Expenses", "Increasing Capital Utilization", "All of the above"], correctAnswerCode: 4 },
            { question: "In Current Ratio, Current Assets are compared with:", options: ["Current Profit", "Current Liabilities", "Fixed Assets", "Equity Share Capital"], correctAnswerCode: 2 },
            { question: "ABC Ltd. has a Current Ratio of 1.5: 1 and Net Current Assets of Rs. 5,00,000. What are the Current Assets?", options: ["Rs. 5,00,000", "Rs. 10,00,000", "Rs. 15,00,000", "Rs. 25,00,000"], correctAnswerCode: 3 },
            { question: "There is deterioration in the management of working capital of XYZ Ltd. What does it refer to?", options: ["That the Capital Employed has reduced", "That the Profitability has gone up", "That debtors collection period has increased", "That Sales has decreased"], correctAnswerCode: 3 },
            { question: "Which of the following does not help to increase Current Ratio?", options: ["Issue of Debentures to buy Stock", "Issue of Debentures to pay Creditors", "Sale of Investment to pay Creditors", "Avail Bank Overdraft to buy Machine"], correctAnswerCode: 4 },
            { question: "Debt to Total Assets Ratio can be improved by:", options: ["Borrowing More", "Issue of Debentures", "Issue of Equity Shares", "Redemption of Debt"], correctAnswerCode: 4 },
            { question: "Ratio of Net Income to Number of Equity Shares known as:", options: ["Price Earnings Ratio", "Net Profit Ratio", "Earnings per Share", "Dividend per Share"], correctAnswerCode: 3 },
            { question: "Trend Analysis helps comparing performance of a firm", options: ["With other firms", "Over a period of firm", "With other industries", "With other companies"], correctAnswerCode: 2 },
            { question: "A Current Ratio of less than one means:", options: ["Current Liabilities < Current Assets", "Fixed Assets > Current Assets", "Current Assets < Current Liabilities", "Share Capital > Current Assets"], correctAnswerCode: 3 },
            { question: "A firm has Capital of Rs. 10,00,000; Sales of Rs. 5,00,000; Gross Profit of Rs. 2,00,000 and Expenses of Rs. 1,00,000. What is the Net Profit Ratio?", options: ["20%", "50%", "10%", "40%"], correctAnswerCode: 1 },
            { question: "XYZ Ltd. has earned 8% Return on Total Assests of Rs. 50,00,000 and has a Net Profit Ratio of 5%. Find out the Sales of the firm.", options: ["Rs. 4,00,000", "Rs. 2,50,000", "Rs. 80,00,000", "Rs. 83,33,333"], correctAnswerCode: 3 },
            { question: "Suppliers and Creditors of a firm are interested in:", options: ["Profitability Position", "Liquidity Position", "Market Share Position", "Debt Position"], correctAnswerCode: 2 },
            { question: "Which of the following is a measure of Debt Service capacity of a firm?", options: ["Current Ratio", "Acid Test Ratio", "Interest Coverage Ratio", "Debtors Turnover"], correctAnswerCode: 3 },
            { question: "Gross Profit Ratio for a firm remains same but the Net Profit Ratio is decreasing. The reason for such behavior could be:", options: ["Increase in Costs of Goods Sold", "If Increase in Expense", "Increase in Dividend", "Decrease in Sales"], correctAnswerCode: 2 },
            { question: "Which of the following statements is correct?", options: ["A Higher Receivable Turnover is not desirable", "Interest Coverage Ratio depends upon Tax Rate", "Increase in Net Profit Ratio means increase in Sales", "Lower Debt-Equity Ratio means lower Financial Risk"], correctAnswerCode: 4 },
            { question: "Debt to Total Assets of a firm is 2. The Debt to Equity would be:", options: ["0.80", "0.25", "1.00", "0.75"], correctAnswerCode: 2 },
            { question: "Which of the following helps analysing return to equity Shareholders?", options: ["Return on Assets", "Earnings Per Share", "Net Profit Ratio", "Return on Investment"], correctAnswerCode: 2 },
            { question: "Return on Assets and Return on Investment Ratios belong to:", options: ["Liquidity Ratios", "Profitability Ratios", "Solvency Ratios", "Turnover"], correctAnswerCode: 2 },
            { question: "XYZ Ltd. has a Debt Equity Ratio of 1.5 as compared to 1.3 Industry average. It means that the firm has:", options: ["Higher Liquidity", "Higher Financial Risk", "Higher Profitability", "Higher Capital Employed"], correctAnswerCode: 2 },
            { question: "Ratio Analysis can be used to study liquidity, turnover, profitability, etc. of a firm. What does Debt-Equity Ratio help to study?", options: ["Solvency", "Liquidity", "Profitability", "Turnover"], correctAnswerCode: 1 },
            { question: "In Inventory Turnover calculation, what is taken in the numerator?", options: ["Sales", "Cost of Goods Sold", "Opening Stock", "Closing Stock"], correctAnswerCode: 2 },
            { question: "Statement of cash flows are included in:", options: ["Ind AS-3", "Ind AS-6", "Ind AS-7", "Ind AS-113"], correctAnswerCode: 3 },
            { question: "Cost of capital refers to:", options: ["Flotation Cost", "Dividend", "Required Rate of Return", "None of the above"], correctAnswerCode: 3 },
            { question: "Which of the following sources of funds has an implicit cost of capital?", options: ["Equity Share Capital", "Preference Share Capital", "Debentures", "Retained earnings"], correctAnswerCode: 4 },
            { question: "Which of the following has the highest cost of capital?", options: ["Equity shares", "Loans", "Bonds", "Preference shares"], correctAnswerCode: 1 },
            { question: "Cost of capital for Government securities is also known as:", options: ["Risk-free Rate of Interest", "Maximum Rate of Return", "Rate of Interest on Fixed Deposits", "None of the above"], correctAnswerCode: 1 },
            { question: "Cost of capital for bonds and debentures is calculated on:", options: ["Before Tax basis", "After Tax basis", "Risk-free Rate of Interest basis", "Compound interest"], correctAnswerCode: 2 },
            { question: "Weighted Average Cost of Capital (WACC) is generally denoted by:", options: ["k", "Kw", "ko", "ke"], correctAnswerCode: 3 },
            { question: "Which of the following cost of capital require tax adjustment?", options: ["Cost of Equity Shares", "Cost of Preference Shares", "Cost of Debentures", "Cost of Retained Earnings"], correctAnswerCode: 3 },
            { question: "Which is the most expensive source of funds?", options: ["New Equity Shares", "New Preference Shares", "New Debts", "Retained Earnings"], correctAnswerCode: 1 },
            { question: "Marginal cost of capital is the cost of:", options: ["Additional Sales", "Additional Funds", "Additional Interests", "Additional Revenue"], correctAnswerCode: 2 },
            { question: "In case the firm is all-equity financed, the WACC would be equal to:", options: ["Cost of Debt", "Cost of Equity", "Neither (1) nor (2)", "Both (1) and (2)"], correctAnswerCode: 2 },
            { question: "In order to calculate Weighted Average Cost of capitals (WACC) weights may be based on:", options: ["Market Values", "Target Values", "Book Values", "All of the above"], correctAnswerCode: 4 },
            { question: "Firm's cost of capital is the average cost of:", options: ["All sources", "All borrowings", "Share capital", "Share, Bonds and Debentures"], correctAnswerCode: 1 },
            { question: "An implicit cost of increasing proportion of debt is:", options: ["Tax should would not be available on new debt", "P/E Ratio would increase", "Equity shareholders would demand higher return", "Rate of Return of the company would decrease."], correctAnswerCode: 3 },
            { question: "Cost of redeemable preference share capital is:", options: ["Rate of Dividend", "After Tax Rate of Dividend", "Discount Rate that equates PV of inflows and out-flows relating to capital", "None of the above"], correctAnswerCode: 3 },
            { question: "Which of the following is true?", options: ["Retained earnings are cost free", "External Equity is cheaper than Internal Equity", "Retained Earnings are cheaper than External Equity", "Retained Earnings are costlier than External Equity"], correctAnswerCode: 3 },
            { question: "Capital Budgeting is a part of:", options: ["Investment Decision", "Working Capital Management", "Marketing Management", "Capital Structure"], correctAnswerCode: 1 },
            { question: "Capital Budgeting deals with:", options: ["Long-term Decisions", "Short-term Decisions", "Both (1) and (2)", "Neither (1) nor (2)"], correctAnswerCode: 1 },
            { question: "Which of the following is not used in Capital Budgeting?", options: ["Time Value of Money", "Sensitivity Analysis", "Net Assets Method", "Cash Flows"], correctAnswerCode: 3 },
            { question: "Capital Budgeting Decisions are:", options: ["Reversible", "Irreversible", "Unimportant", "All of the above"], correctAnswerCode: 2 },
            { question: "Which of the following is not incorporated in Capital Budgeting?", options: ["Tax-Effect", "Time Value of Money", "Required Rate of Return", "Rate of Cash Discount"], correctAnswerCode: 4 },
            { question: "Which of the following is not a capital budgeting decision?", options: ["Expansion Programme", "Merger", "Replacement of an Asset", "Inventory Level"], correctAnswerCode: 4 },
            { question: "A sound Capital Budgeting technique is based on:", options: ["Cash Flows", "Accounting Profit", "Interest Rate on Borrowings", "Last Dividend Paid"], correctAnswerCode: 1 },
            { question: "Which of the following is not a relevant cost in Capital Budgeting?", options: ["Sunk Cost", "Opportunity Cost", "Allocated Overheads", "Both (1) and (3) above"], correctAnswerCode: 4 },
            { question: "Capital Budgeting Decisions are based on:", options: ["Incremental Profit", "Incremental Cash Flows", "Incremental Assets", "Incremental Capital"], correctAnswerCode: 2 },
            { question: "Which of the following does not effect cash flows proposal?", options: ["Salvage Value", "Depreciation Amount", "Tax Rate Change", "Method of Project Financing"], correctAnswerCode: 4 },
            { question: "Cash Inflows from a project include:", options: ["Tax Shield of Depreciation", "After-tax Operating Profits", "Raising of Funds", "Both (1) and (2)"], correctAnswerCode: 4 },
            { question: "Which of the following is not true with reference capital budgeting?", options: ["Capital budgeting is related to asset replacement decisions", "Cost of capital is equal to minimum required return", "Existing investment in a project is not treated as sunk cost", "Timing of cash flows is relevant"], correctAnswerCode: 3 },
            { question: "Which of the following is not followed in capital budgeting?", options: ["Cash flows Principle", "Interest Exclusion Principle", "Accrual Principle", "Post-tax Principle"], correctAnswerCode: 3 },
            { question: "Depreciation is incorporated in cash flows because it:", options: ["Is unavoidable cost", "Is a cash flow", "Reduces Tax liability", "Involves an outflow"], correctAnswerCode: 3 },
            { question: "Which of the following is not true for capital budgeting?", options: ["Sunk costs are ignored", "Opportunity costs are excluded", "Incremental cash flows are considered", "Relevant cash flows are considered"], correctAnswerCode: 2 },
            { question: "Which of the following is not applied in capital budgeting?", options: ["Cash flows be calculated in incremental terms", "All costs and benefits are measured on cash basis", "All accrued costs and revenues be incorporated", "All benefits are measured on after-tax basis"], correctAnswerCode: 3 },
            { question: "Evaluation of Capital Budgeting proposals is based on Cash Flows because:", options: ["Cash Flows are easy to calculate", "Cash Flows are suggested by SEBI", "Cash is more important than profit", "Cash Flows are suggested by RBI"], correctAnswerCode: 3 },
            { question: "Which of the following is not included in incremental A flows? (Assuming 'A' means Cash)", options: ["Opportunity Costs", "Sunk Costs", "Change in Working Capital", "Inflation effect"], correctAnswerCode: 2 },
            { question: "A proposal is not a Capital Budgeting proposal if it:", options: ["is related to Fixed Assets", "brings long-term benefits", "brings short-term benefits only", "has very large investment"], correctAnswerCode: 3 },
            { question: "In Capital Budgeting, Sunk cost is excluded because it is:", options: ["of small amount", "not incremental", "not reversible", "All of the above"], correctAnswerCode: 2 },
            { question: "Savings in respect of a cost is treated in capital budgeting as:", options: ["An Inflow", "An Outflow", "Opening balance", "Closing balance"], correctAnswerCode: 1 },
            { question: "________ ignores the time value of money.", options: ["Internal Rate of Return (IRR)", "Average Rate of Return (ARR)", "Net Present Value (NPV)", "Profitability Index (PI)"], correctAnswerCode: 2 },
            { question: "The discounted cash flows techniques are:", options: ["Net Present Value (NPV)", "Internal Rate of Return (IRR)", "Profitability Index (PI)", "All of the above"], correctAnswerCode: 4 },
            { question: "Working capital is calculated as", options: ["Core current assets less core current liabilities", "Current assets less current liabilities", "Core current assets less current liabilities", "Liquid assets less current liabilities"], correctAnswerCode: 2 },
            { question: "The basic current liabilities are", options: ["accounts payable and bills payable", "bank overdraft", "outstanding expenses", "All of the above"], correctAnswerCode: 4 },
            { question: "There are two concepts of working capital-gross and", options: ["Zero", "Net", "Cumulative", "distinctive"], correctAnswerCode: 2 },
            { question: "Working capital is also known as ________ capital.", options: ["Current asset", "Operating", "Projecting", "Operation capital"], correctAnswerCode: 2 },
            { question: "________ working Capital refers to the firm's investment in current assets.", options: ["Zero", "Net", "Gross", "Distinctive"], correctAnswerCode: 3 },
            { question: "In finance, \"working capital\" means the same thing as ________ assets.", options: ["Current", "Fixed", "Total", "All of the above"], correctAnswerCode: 1 },
            { question: "________ working capital refers to the difference between current assets and current liabilities.", options: ["Zero", "Net", "Gross", "Distinctive"], correctAnswerCode: 2 },
            { question: "A ________ net working capital will arise when current assets exceed current liabilities.", options: ["Summative", "Negative", "Excessive", "Positive"], correctAnswerCode: 4 },
            { question: "A ________ net working capital occurs when current liabilities are in excess of current assets.", options: ["Positive", "Negative", "Excessive", "Zero"], correctAnswerCode: 2 },
            { question: "X Ltd. distributes its products to more than 500 retailers. The company's collection period is 30 days and keeps its inventory for 20 days. The operating cycle would be:", options: ["40 Days", "43 Days", "45 Days", "50 Days"], correctAnswerCode: 4 },
            { question: "________ refers to the funds, which an organisation must possess to finance its day to day operations.", options: ["Retained earnings", "Fixed capital", "Working Capital", "All of the above"], correctAnswerCode: 3 },
            { question: "Investment in current assets should be", options: ["just adequate", "more", "less", "maximum"], correctAnswerCode: 1 },
            { question: "________ varies inversely with profitability.", options: ["Risk", "Assets", "Liquidity", "Revenue"], correctAnswerCode: 3 },
            { question: "Capital intensive firms rely on", options: ["debt", "retained earnings", "short term debts", "equity"], correctAnswerCode: 1 },
            { question: "On the basis of ________, working capital is classified as gross working capital and net working capital.", options: ["concept", "time", "future", "work"], correctAnswerCode: 1 },
            { question: "________ cycle analyzes the accounts receivable, inventory, and accounts payable cycles in terms of a number of days?", options: ["Business", "Current asset", "Operation", "Operating"], correctAnswerCode: 4 },
            { question: "________ method is not used for calculating working capital cycle.", options: ["Trial and error method", "Regression analysis method", "Percentage of sales method", "Operating cycle approach"], correctAnswerCode: 1 },
            { question: "On the basis of ________, working capital may be classified as: 1) Permanent or fixed working capital. 2) Temporary or variable working capital.", options: ["concept", "time", "future", "work"], correctAnswerCode: 2 },
            { question: "Operating cycle is also called as", options: ["Business cycle", "Working capital cycle", "Working cycle", "Current asset cycle"], correctAnswerCode: 2 },
            { question: "Spontaneous financing consists of", options: ["a line of credit", "short-term loans", "accounts receivable", "accounts payable"], correctAnswerCode: 4 },
            { question: "Conversation of marketable securities into cash entails a fixed cost of Rs.1,000 per transaction. What will be the optimal conversation size as per Baumol model of cash management? (Assume annual cash requirement T = Rs. X, interest rate i = Y%)", options: ["Rs. 315,628", "Rs. 316,228", "Rs. 317.678", "Rs. 318,426"], correctAnswerCode: 2 },
            { question: "Average collection period is 2 months, cash sales and average receivables are Rs.5,00,000 and Rs.6,50,000 respectively. The sales amount would be-", options: ["Rs. 40,00,000", "Rs. 42,00,000", "Rs. 44,00,000", "Rs. 48,50,000"], correctAnswerCode: 3 },
            { question: "If the current ratio is 2.4:1 and working capital is Rs.25,20,000, find the amount of current assets and current liabilities.", options: ["Current Assets Rs. 43,20,000 and Current Liabilities Rs. 18,00,000", "Current Assets Rs. 44,00,000 and Current Liabilities Rs.18,50,000", "Current Assets Rs. 45,50,000 and Current Liabilities Rs. 19.00.000", "Current Assets Rs. 46,60,000 and Current Liabilities Rs. 19,30,000"], correctAnswerCode: 1 },
            { question: "Operating leverage helps in analysis of:", options: ["Business Risk", "Financing Risk", "Production Risk", "Credit Risk"], correctAnswerCode: 1 },
            { question: "Which of the following is studied with the help of financial leverage?", options: ["Marketing Risk", "Interest Rate Risk", "Foreign Exchange Risk", "Financing risk"], correctAnswerCode: 4 },
            { question: "Combined Leverage is obtained from OL and FL by their:", options: ["Addition", "Subtraction", "Multiplication", "Any of these"], correctAnswerCode: 3 },
            { question: "High degree of financial leverage means:", options: ["High debt proportion", "Lower debt proportion", "Equal debt and equity", "No debt"], correctAnswerCode: 1 },
            { question: "Operating leverage arises because of:", options: ["Fixed Cost of Production", "Fixed Interest Cost", "Variable Cost", "Step Cost"], correctAnswerCode: 1 },
            { question: "Financial Leverage arises because of:", options: ["Fixed cost of production", "Variable Cost", "Interest Cost", "Step Cost"], correctAnswerCode: 3 },
            { question: "Operating Leverage is calculated as:", options: ["Contribution EBIT", "EBIT-PBT", "EBIT -Interest", "EBIT -Tax"], correctAnswerCode: 1 },
            { question: "Financial Leverage is calculated as:", options: ["EBIT Contribution", "EBIT PBT", "EBIT- Sales", "EBIT Variable Cost"], correctAnswerCode: 2 },
            { question: "Which combination is generally good for firms?", options: ["High Operating leverage, High Financial leverage", "Low Operating leverage, Low Financial leverage", "High Operating leverage, Low Financial leverage", "Moderate Operating leverage. Moderate Financial leverage"], correctAnswerCode: 3 },
            { question: "Combined leverage can be used to measure the relationship between:", options: ["EBIT and EPS", "PAT and EPS", "Sales and EPS", "Sales and EBIT"], correctAnswerCode: 3 },
            { question: "Financial Leverage is zero if:", options: ["EBIT Interest", "EBIT = Zero", "EBIT Fixed Cost", "EBIT  Pref. Dividend"], correctAnswerCode: 2 },
            { question: "Business risk can be measured by:", options: ["Financial leverage", "Operating leverage", "Combined leverage", "All of the above"], correctAnswerCode: 2 },
            { question: "Financial Leverage measures relationship between", options: ["EBIT and PBT", "EBIT and EPS", "Sales and PBT", "Sales and EPS"], correctAnswerCode: 2 },
            { question: "Use of Preference Share Capital in Capital structure", options: ["Increases Operating leverage", "Increases Financial leverage", "Decreases Operating leverage", "Decreases Financial leverage"], correctAnswerCode: 2 },
            { question: "Relationship between change in sales and change in EPS is measured by:", options: ["Financial leverage", "Combined leverage", "Operating leverage", "All of the above"], correctAnswerCode: 2 },
            { question: "Numerical data may be expressed as:", options: ["In the form of text", "In the form of numbers", "In the form of images", "All of the above"], correctAnswerCode: 2 },
            { question: "The descriptive data may be deciphered as:", options: ["May be deciphered in the form of qualitative information", "May be deciphered in the form of quantitative information", "May be deciphered in the form of information from informal sources", "All of the above"], correctAnswerCode: 1 },
            { question: "Data represented in the form of picture is termed as:", options: ["Graphic data", "Qualitative data", "Quantitative data", "All of the above"], correctAnswerCode: 1 },
            { question: "Which of the following is/are the reason for digitization?", options: ["Helps in work processing", "Requires less physical storage space", "Digitized records may be accessed by more than one person simultaneously", "All of the above"], correctAnswerCode: 4 }, // Corrected based on PDF key.
            { question: "To make the data turn into user friendly information, it should go one/more of following core steps:", options: ["Collection of data", "Organising the data", "Data processing", "All of the above"], correctAnswerCode: 4 },
            { question: "Any data expressed as a number is a ________ data.", options: ["graphical", "descriptive", "numerical", "None of the above"], correctAnswerCode: 3 },
            { question: "Classifying equities into small-cap, mid-cap, and large-cap categories are the examples of ________ Scale", options: ["Nominal", "Ordinal", "Interval", "Ratio"], correctAnswerCode: 2 }, // Corrected to Ordinal as there's an order. PDF key was 1.
            { question: "Which of the following is a phase for a process of digitization?", options: ["Justification of the proposed digitization project", "Assessment", "Planning", "All of the above"], correctAnswerCode: 4 },
            { question: "Data science plays an important role in:", options: ["Risk analytics", "Customer data management", "Consumer analytics", "All of the above"], correctAnswerCode: 4 },
            { question: "The primary benefit of data distribution is:", options: ["the estimation of the probability of any certain observation within a sample space", "the estimation of the probability of any certain observation within a non-sample space", "the estimation of the probability of any certain observation within a population", "the estimation of the probability of any certain observation without a non-sample space"], correctAnswerCode: 1 },
            { question: "Binomial distribution applies to attributes:", options: ["within a sample space that are categorised into two mutually exclusive and exhaustive classes", "within a non-sample space that are categorised into three mutually exclusive and exhaustive classes", "within a population that are categorised into less than two mutually exclusive and exhaustive classes", "without a non-sample space that are categorised into four mutually exclusive and exhaustive classes"], correctAnswerCode: 1 },
            { question: "The geometric distribution is a discrete distribution that assesses:", options: ["the probability of the occurrence of the first success", "the probability of the occurrence of the second success", "the probability of the occurrence of the third success", "the probability of the occurrence of the less success"], correctAnswerCode: 1 },
            { question: "The probability density function describes:", options: ["the characteristics of a random variable", "the characteristics of a non-random variable", "the characteristics of a random constant", "the characteristics of a non-random constant"], correctAnswerCode: 1 },
            { question: "When independent variables with standard normal distribution are squared and added, the ________ distribution occurs", options: ["Normal", "Chi square", "Exponential", "Lognormal"], correctAnswerCode: 2 },
            { question: "The procedure that organises data into a meaningful order to make it simpler to comprehend, analyse, and visualise, is called", options: ["Data validation", "Data sorting", "Data aggregation", "Data analysis"], correctAnswerCode: 2 },
            { question: "Following is a widely used graph for data Visualisation:", options: ["Bar chart", "Pie chart", "Histogram", "All of the above"], correctAnswerCode: 4 },
            { question: "Following are the objectives of data visualisation:", options: ["Making a better data analysis", "Faster decision making", "Analysing complicated data", "All of the above"], correctAnswerCode: 4 },
            { question: "Following are the scope of DPA: (Data Presentation Architecture)", options: ["Defining significant meaning (relevant information) required by each audience member in every scenario.", "Obtaining the proper data (focus area. historic reach, extensiveness, level of detail, etc.)", "Determining the needed frequency of data refreshes (the currency of the data)", "All of the above"], correctAnswerCode: 4 },
            { question: "Maps may be used for displaying:", options: ["Pincode", "Country name", "State abbreviation", "All of the above"], correctAnswerCode: 4 },
            { question: "A scatter plot displays several unique data points:", options: ["on a single graph", "On two different graphs", "On four different graphs", "None of the above"], correctAnswerCode: 1 },
            { question: "A ________ chart depicts tasks that must be accomplished before others may begin, as well as the allocation of resources.", options: ["Bubble", "Gantt", "Scatter", "Density"], correctAnswerCode: 2 },
            { question: "________ is a set of skills that aims to identify, find, modify, format, and present data in a manner that ideally conveys meaning and provides insight.", options: ["Data Presentation Architecture", "Data Presentation Hierarchy", "Data Visualization Architecture", "None of the above"], correctAnswerCode: 1 },
            { question: "Which of the following is a data discovery platform that enables users to make quicker, more informed choices by speeding analytics, uncovering new business insights, and enhancing the precision of outcomes?", options: ["Microsoft Excel", "Microsoft Power BI", "QlikView", "Tableau"], correctAnswerCode: 3 },
            { question: "Which of the following is/ are the benefit/ benefits of data analytics?", options: ["Improves decision making process", "Increase in efficiency of operations", "Improved service to stakeholders", "All of the above"], correctAnswerCode: 4 },
            { question: "Which of the following is/ are the technique/s of data mining?", options: ["Association rules", "Neural network", "Decision tree", "All of the above"], correctAnswerCode: 4 },
            { question: "XML is the abbreviated form of:", options: ["Extensible mark-up language", "Extended mark-up language", "Extendable mark-up language", "Extensive mark-up language"], correctAnswerCode: 1 },
            { question: "XBRL is the abbreviated form of:", options: ["eXtensible Business Reporting Language", "eXtensive Business Reporting Language", "eXtended Business Reporting Language", "eXtensive Business Reporting Language"], correctAnswerCode: 1 },
            { question: "Which of the following is/ are the types of cloud computing?", options: ["Private cloud", "Public cloud", "Hybrid cloud", "All of the above"], correctAnswerCode: 4 },
            { question: "On the basis of the type of “signal” or “feedback” provided to the learning system, which of the following is not a type of machine learning?", options: ["Supervised learning", "Unsupervised learning", "Semi supervised learning", "Robotic Process learning"], correctAnswerCode: 4 },
            { question: "In recent years, business intelligence has expanded to incorporate more procedures and activities designed to enhance performance. These procedures consist of:", options: ["Data mining", "Reporting", "Querying", "All of the above"], correctAnswerCode: 4 }
        ];

        let currentScore = 0;
        let questionsAnswered = 0;
        let currentQuestionSet = []; // Holds questions for the currently selected set
        let totalQuestionsInCurrentSet = 0; // Total questions in the currently selected set
        
        // Calculate questions per set. 174 total questions.
        // Sets 1-4: 35 questions. Set 5: 34 questions.
        const questionsPerSetArray = [35, 35, 35, 35, 34];
        const totalSets = questionsPerSetArray.length;


        /**
         * Sanitizes HTML string by replacing < and > characters.
         * Also replaces newline characters with <br> for display.
         */
        function sanitizeHTML(str) {
            if (typeof str !== 'string') return '';
            let sanitized = str.replace(/</g, "&lt;").replace(/>/g, "&gt;");
            return sanitized.replace(/\n/g, "<br>");
        }

        /**
         * Creates the set selection buttons.
         */
        function createSetSelectionControls() {
            const container = document.getElementById('setSelectionContainer');
            if (!container) return;

            const buttonsDivId = 'set-buttons-wrapper';
            let buttonsDiv = container.querySelector(`#${buttonsDivId}`);
            if (!buttonsDiv) {
                buttonsDiv = document.createElement('div');
                buttonsDiv.id = buttonsDivId;
                container.appendChild(buttonsDiv);
            }
            buttonsDiv.innerHTML = ''; // Clear previous buttons

            if (allQuestionsData.length > 0) {
                for (let i = 0; i < totalSets; i++) {
                    const button = document.createElement('button');
                    button.textContent = `Set ${i + 1} (${questionsPerSetArray[i]} Qs)`;
                    button.classList.add('set-button');
                    button.onclick = function() { loadQuestionSet(i); };
                    buttonsDiv.appendChild(button);
                }
            } else {
                 buttonsDiv.innerHTML = '<p class="text-red-500">No questions loaded to create sets.</p>';
            }
        }

        /**
         * Loads and displays a specific set of questions.
         * @param {number} setIndex - The 0-based index of the set to load.
         */
        function loadQuestionSet(setIndex) { // setIndex is 0-based
            const quizArea = document.getElementById('quizArea');
            const initialMessage = document.getElementById('initialMessage');
            if (!quizArea || !initialMessage) return;

            let startIndex = 0;
            for(let i = 0; i < setIndex; i++) {
                startIndex += questionsPerSetArray[i];
            }
            const questionsInThisSet = questionsPerSetArray[setIndex];
            const endIndex = startIndex + questionsInThisSet;

            currentQuestionSet = allQuestionsData.slice(startIndex, endIndex);
            totalQuestionsInCurrentSet = currentQuestionSet.length; 

            if (totalQuestionsInCurrentSet === 0) {
                console.warn(`Attempted to load Set ${setIndex + 1}, but it has no questions. Check 'allQuestionsData'.`);
                document.getElementById('quizForm').innerHTML = '<p class="text-center text-red-600">This question set is empty or could not be loaded.</p>';
                updateLiveScoreboard();
                quizArea.style.display = 'block';
                initialMessage.style.display = 'none';
                return;
            }

            currentScore = 0;
            questionsAnswered = 0;
            
            buildQuizDisplay(currentQuestionSet, setIndex); 
            updateLiveScoreboard();

            const resultSummaryDiv = document.getElementById('resultSummary');
            if (resultSummaryDiv) {
                resultSummaryDiv.style.display = 'none';
                resultSummaryDiv.textContent = '';
            }
            const submitButton = document.getElementById('submitButton');
            if (submitButton) {
                submitButton.disabled = false;
                submitButton.textContent = "Submit Answers";
            }

            quizArea.style.display = 'block';
            initialMessage.style.display = 'none';

            const setButtons = document.querySelectorAll('.set-button');
            setButtons.forEach((btn, idx) => {
                btn.classList.toggle('active-set', idx === setIndex);
            });
        }

        /**
         * Builds the quiz HTML structure for the given questions and injects it into the form.
         * @param {Array} questionsToDisplay - The array of question objects for the current set.
         * @param {number} currentSetGlobalIndex - The 0-based global index of the current set.
         */
        function buildQuizDisplay(questionsToDisplay, currentSetGlobalIndex) {
            const quizForm = document.getElementById('quizForm');
            if (!quizForm) {
                console.error("Quiz form element not found!");
                return;
            }
            let html = '';
            questionsToDisplay.forEach((q, indexInSet) => { 
                let originalQuestionIndex = 0;
                for(let i=0; i < currentSetGlobalIndex; i++) {
                    originalQuestionIndex += questionsPerSetArray[i];
                }
                originalQuestionIndex += indexInSet;

                html += `<div class="question-block" id="question-${indexInSet}">`;
                html += `   <p class="question-text">${indexInSet + 1}. ${sanitizeHTML(q.question)}</p>`;
                html += `   <div class="options">`;
                q.options.forEach((option, i) => {
                    const optionValue = i + 1;
                    html += `       <label for="q${indexInSet}_option${optionValue}">`;
                    html += `           <input type="radio" name="q${indexInSet}" id="q${indexInSet}_option${optionValue}" value="${optionValue}" onchange="checkAnswer(${indexInSet})">`;
                    html += `           <span>${sanitizeHTML(option)}</span>`;
                    html += `       </label>`;
                });
                html += `   </div>`;
                html += `   <div class="feedback-container">`;
                html += `       <div class="feedback" id="feedback-${indexInSet}"></div>`;
                html += `       <button type="button" class="explain-btn" id="explain-btn-${indexInSet}" onclick="getExplanation(${originalQuestionIndex})">✨ Explain Concept</button>`;
                html += `       <div class="explanation-area" id="explanation-${indexInSet}" style="display:none;"></div>`;
                html += `   </div>`;
                html += `</div>`;
            });
            quizForm.innerHTML = html;
        }

        /**
         * Updates the live scoreboard display.
         */
        function updateLiveScoreboard() {
            const scoreboard = document.getElementById('liveScoreboard');
            if (scoreboard) {
                scoreboard.textContent = `Score: ${currentScore} / ${totalQuestionsInCurrentSet} | Answered: ${questionsAnswered} / ${totalQuestionsInCurrentSet}`;
            }
        }

        /**
         * Checks the answer for a given question in the current set, provides feedback, and updates the score.
         * @param {number} questionIndexInSet - The index of the question in currentQuestionSet.
         */
        function checkAnswer(questionIndexInSet) {
            const questionData = currentQuestionSet[questionIndexInSet];
            const form = document.getElementById('quizForm');
            const feedbackDiv = document.getElementById(`feedback-${questionIndexInSet}`);
            const radioButtons = form.elements[`q${questionIndexInSet}`];
            const explainButton = document.getElementById(`explain-btn-${questionIndexInSet}`);
            
            if (!questionData || !form || !feedbackDiv || !radioButtons || !explainButton) {
                console.error(`Elements for question ${questionIndexInSet} in current set not found.`);
                return;
            }

            if (radioButtons[0] && radioButtons[0].disabled) { 
                return; 
            }

            let selectedOptionValue = null;
            for (let i = 0; i < radioButtons.length; i++) {
                if (radioButtons[i].checked) {
                    selectedOptionValue = radioButtons[i].value;
                }
                radioButtons[i].disabled = true;
                if (radioButtons[i].parentElement && radioButtons[i].parentElement.tagName === 'LABEL') {
                    radioButtons[i].parentElement.classList.add('disabled-option');
                }
            }

            if (selectedOptionValue === null) return;

            questionsAnswered++;

            const correctAnswerCode = questionData.correctAnswerCode;
            const correctAnswerText = (correctAnswerCode > 0 && questionData.options && correctAnswerCode <= questionData.options.length)
                                      ? sanitizeHTML(questionData.options[correctAnswerCode - 1])
                                      : "N/A";

            feedbackDiv.className = 'feedback'; 
            if (parseInt(selectedOptionValue) === correctAnswerCode) {
                currentScore++;
                feedbackDiv.innerHTML = `Correct! The answer is: ${correctAnswerText}`;
                feedbackDiv.classList.add('correct-answer-text');
            } else {
                const userAnswerText = (questionData.options && parseInt(selectedOptionValue) > 0 && parseInt(selectedOptionValue) <= questionData.options.length)
                                       ? sanitizeHTML(questionData.options[parseInt(selectedOptionValue) - 1])
                                       : "N/A";
                feedbackDiv.innerHTML = `<span class="user-answer-display">Your answer: ${userAnswerText}</span>Incorrect. The correct answer is: ${correctAnswerText}`;
                feedbackDiv.classList.add('incorrect-answer-text');
            }
            feedbackDiv.style.display = 'block';
            explainButton.style.display = 'inline-block';
            updateLiveScoreboard();
        }
        
        /**
         * Fetches and displays an explanation for the given question using the Gemini API.
         * @param {number} originalQuestionIndex - The original index of the question in allQuestionsData.
         */
        async function getExplanation(originalQuestionIndex) {
            const questionData = allQuestionsData[originalQuestionIndex]; 
            
            let currentSetGlobalIndex = 0;
            let cumulativeQuestions = 0;
            for(let i=0; i < questionsPerSetArray.length; i++){
                if(originalQuestionIndex < cumulativeQuestions + questionsPerSetArray[i]){
                    currentSetGlobalIndex = i;
                    break;
                }
                cumulativeQuestions += questionsPerSetArray[i];
            }
            const questionIndexInSet = originalQuestionIndex - cumulativeQuestions;

            const explanationArea = document.getElementById(`explanation-${questionIndexInSet}`);
            const explainButton = document.getElementById(`explain-btn-${questionIndexInSet}`);

            if (!questionData || !explanationArea || !explainButton) {
                console.error("Could not find elements for explanation. Original Index:", originalQuestionIndex, "Calculated Index in Set:", questionIndexInSet);
                if (explanationArea) explanationArea.innerHTML = `<p class="incorrect-answer-text">Error: Could not find explanation elements.</p>`;
                return;
            }

            explainButton.disabled = true;
            explanationArea.innerHTML = `<p class="loading-message">✨ Fetching explanation...</p>`;
            explanationArea.style.display = 'block';

            const questionText = questionData.question;
            const plainOptions = questionData.options.map(opt => opt.replace(/<br\s*\/?>/gi, ' '));
            const correctAnswerText = (questionData.options && questionData.correctAnswerCode > 0 && questionData.correctAnswerCode <= plainOptions.length) 
                                      ? plainOptions[questionData.correctAnswerCode - 1] 
                                      : "Not Available";
            
            const prompt = `Explain the concept behind this multiple-choice question related to Financial Management or Business Data Analytics and why the stated correct answer is indeed correct. Question: "${questionText.replace(/<br\s*\/?>/gi, ' ')}" Options were: ${plainOptions.join('; ')}. The correct answer is: "${correctAnswerText}". Keep the explanation concise, clear, and suitable for a student. Focus on the core principle.`;

            let chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
            const payload = { contents: chatHistory };
            const apiKey = ""; 
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    console.error("API Error:", errorData);
                    explanationArea.innerHTML = `<p class="incorrect-answer-text">Sorry, couldn't fetch an explanation. Error: ${errorData.error?.message || response.statusText}</p>`;
                    return; 
                }

                const result = await response.json();
                
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const explanationText = result.candidates[0].content.parts[0].text;
                    explanationArea.innerHTML = sanitizeHTML(explanationText);
                } else {
                    explanationArea.innerHTML = `<p class="incorrect-answer-text">Sorry, the explanation format was unexpected.</p>`;
                    console.error("Unexpected API response structure:", result);
                }
            } catch (error) {
                console.error("Fetch Error:", error);
                explanationArea.innerHTML = `<p class="incorrect-answer-text">An error occurred while fetching the explanation.</p>`;
            } finally {
                 explainButton.disabled = false; 
            }
        }

        /**
         * Displays the final score summary for the current set.
         */
        function submitCurrentQuiz() {
            const resultSummaryDiv = document.getElementById('resultSummary');
            if (!resultSummaryDiv) {
                console.error("Result summary element not found!");
                return;
            }

            if (questionsAnswered < totalQuestionsInCurrentSet) {
                const unAnsweredCount = totalQuestionsInCurrentSet - questionsAnswered;
                resultSummaryDiv.innerHTML = `Please answer all ${totalQuestionsInCurrentSet} questions. You have ${unAnsweredCount} unanswered.`;
                resultSummaryDiv.className = 'result-summary error';
                resultSummaryDiv.style.display = 'block';
                resultSummaryDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
                return;
            }

            resultSummaryDiv.innerHTML = `Quiz Set Complete! Your final score is ${currentScore} out of ${totalQuestionsInCurrentSet}. (${((currentScore/totalQuestionsInCurrentSet)*100).toFixed(2)}%)`;
            resultSummaryDiv.className = 'result-summary ' + (currentScore >= totalQuestionsInCurrentSet / 2 ? 'success' : 'error');
            resultSummaryDiv.style.display = 'block';
            resultSummaryDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });

            const submitButton = document.getElementById('submitButton');
            if (submitButton) {
                submitButton.disabled = true;
                submitButton.textContent = "Quiz Submitted";
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            if (allQuestionsData.length === 0) {
                console.error("CRITICAL: No questions found in 'allQuestionsData'. Quiz cannot be initialized.");
            }
            createSetSelectionControls();
        });
    </script>
</body>
</html>
