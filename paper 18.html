<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paper 6: Financial Accounting | Prepogy</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root {
            /* Theme Palette from Index */
            --theme-purple: #8b5fbf;
            --theme-blue: #4A90E2;
            --theme-yellow: #F5A623;
            --theme-pink: #ff6b9d;
            --theme-cyan: #4fd1c7;
            --theme-green: #48bb78;
            --text-dark: #333333;
            --text-light: #555555;
            --bg-light: #f7faff;
            --bg-white: #ffffff;
            --border-light: #e0e6ed;
            
            /* Gradients */
            --gradient-colorful: linear-gradient(135deg, var(--theme-purple), var(--theme-blue), var(--theme-pink), var(--theme-yellow));
            --gradient-ocean: linear-gradient(135deg, var(--theme-blue) 0%, var(--theme-cyan) 100%);
            --gradient-purple-blue: linear-gradient(135deg, var(--theme-purple) 0%, var(--theme-blue) 100%);
        }

        /* --- Animations --- */
        @keyframes rise {
            from { transform: translateY(0) rotate(0deg); opacity: 0.5; }
            to { transform: translateY(-120vh) rotate(360deg); opacity: 0; }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(30px); }
            to { opacity: 1; transform: translateX(0); }
        }
        .animate-slideInRight {
            animation: slideInRight 0.4s ease-out;
        }

        @keyframes pop {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.03); }
        }

        @keyframes confetti-fall {
            0% { transform: translateY(-100px) rotateZ(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotateZ(360deg); opacity: 0; }
        }
        .confetti-particle {
            position: fixed;
            top: 0;
            left: 0;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            pointer-events: none;
            z-index: 9999;
            animation: confetti-fall 3s linear forwards;
        }


        /* --- Base Styles --- */
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-light);
            color: var(--text-dark);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden;
        }

        /* --- Background Shapes --- */
        .shape-container {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: -1; overflow: hidden;
        }
        .shape {
            position: absolute; bottom: -150px; opacity: 0.3;
            animation: rise 20s linear infinite;
            font-weight: 700; line-height: 1; display: block;
        }
        /* A few shapes for context */
        .shape1 { left: 10%; font-size: 55px; color: var(--theme-yellow); animation-duration: 22s; animation-delay: -2s; }
        .shape2 { left: 20%; font-size: 45px; color: var(--theme-blue); animation-duration: 18s; animation-delay: -5s; }
        .shape3 { left: 80%; font-size: 65px; color: var(--theme-purple); opacity: 0.2; animation-duration: 28s; animation-delay: -1s; }
        .shape4 { left: 50%; font-size: 55px; color: var(--theme-pink); animation-duration: 20s; animation-delay: -3s; }
        .shape5 { left: 70%; font-size: 45px; color: var(--theme-cyan); animation-duration: 25s; animation-delay: -8s; }
        .shape6 { left: 90%; font-size: 60px; color: var(--theme-yellow); animation-duration: 19s; animation-delay: -4s; }


        /* --- Main UI Components --- */
        .quiz-wrapper {
            width: 100%;
            max-width: 800px;
            z-index: 1;
        }

        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            animation: fadeInUp 0.5s ease-out;
            padding: 0 10px;
        }

        .home-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: var(--gradient-purple-blue);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(139, 95, 191, 0.2);
        }
        .home-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 25px rgba(139, 95, 191, 0.3);
        }
        .home-btn i {
            font-size: 0.9em;
        }
        
        /* Set Navigation */
        #set-navigation-container {
            width: 100%;
            max-width: 800px;
            background: var(--bg-white);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--border-light);
            text-align: center;
            animation: fadeInUp 0.5s ease-out;
        }
        #set-navigation-container label {
            font-weight: 600;
            color: var(--text-dark);
            margin-right: 15px;
            font-size: 1.1rem;
            vertical-align: middle;
        }
        #set-selector {
            padding: 10px 15px;
            border-radius: 12px;
            border: 2px solid var(--border-light);
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            font-weight: 500;
            background-color: var(--bg-light);
            color: var(--text-dark);
            cursor: pointer;
            transition: border-color 0.3s;
            vertical-align: middle;
        }
        #set-selector:hover {
            border-color: var(--theme-blue);
        }
        #set-selector:focus {
            outline: none;
            border-color: var(--theme-blue);
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.3);
        }


        /* Scoreboard */
        .scoreboard-container {
            background: var(--gradient-purple-blue);
            color: #ffffff;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 10px 20px rgba(139, 95, 191, 0.2);
            width: 100%;
            max-width: 800px;
            margin-bottom: 25px;
            animation: fadeInUp 0.6s ease-out;
        }
        
        #scoreboard {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            font-size: 1rem;
            font-weight: 500;
            gap: 10px;
        }

        #scoreboard span {
            margin: 5px 10px;
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 15px;
            border-radius: 12px;
            text-align: center;
        }
        
        /* Quiz Card */
        .quiz-card {
            background: var(--bg-white);
            border-radius: 25px;
            padding: 30px 40px;
            border: 1px solid var(--border-light);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.05);
            /* animation: fadeInUp 0.7s ease-out; */ /* We will trigger animation with JS */
            position: relative;
            overflow: hidden; /* To contain the slide-in animation */
        }

        .question-container {
             /* This container will hold the animated content */
        }

        .question-header {
            color: var(--theme-blue);
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            border-bottom: 1px solid var(--border-light);
            padding-bottom: 10px;
        }

        .question-text {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 30px;
            line-height: 1.6;
        }
        
        .question-text span.blank-span {
            display: inline-block;
            width: 60px;
            height: 1.2em;
            border-bottom: 2px solid var(--theme-purple);
            margin: 0 4px;
            vertical-align: bottom;
        }

        /* Options */
        .options-container {
            margin-bottom: 20px;
        }

        .option {
            display: flex;
            align-items: flex-start; /* Align with text start */
            padding: 15px 20px;
            margin-bottom: 15px;
            border: 2px solid var(--border-light);
            background-color: var(--bg-light);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .option:last-child {
            margin-bottom: 0;
        }

        .option:hover:not(.disabled) {
            border-color: var(--theme-blue);
            transform: translateX(5px);
            background-color: #f0f7ff;
        }

        .option-letter {
            width: 35px;
            height: 35px;
            background: var(--bg-white);
            border: 1px solid var(--border-light);
            color: var(--text-light);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            margin-right: 15px;
            flex-shrink: 0;
            transition: all 0.3s;
            margin-top: 2px; /* Align with first line of text */
        }
        .option-text {
            flex-grow: 1;
            line-height: 1.5;
        }

        /* States */
        .option.selected { 
            border-color: var(--theme-blue); 
            background-color: #eef6ff; 
        }
        .option.selected .option-letter { 
            background: var(--theme-blue); 
            color: white; 
            border-color: var(--theme-blue);
        }

        .option.correct-answer { 
            border-color: var(--theme-green); 
            background-color: #f0fff4; 
            animation: pop 0.3s ease-out;
        }
        .option.correct-answer .option-letter { 
            background: var(--theme-green); 
            color: white;
            border-color: var(--theme-green);
        }

        .option.incorrect-selection { 
            border-color: var(--theme-pink); 
            background-color: #fff0f6; 
            animation: pop 0.3s ease-out;
        }
        .option.incorrect-selection .option-letter { 
            background: var(--theme-pink); 
            color: white;
            border-color: var(--theme-pink);
        }
        
        .option.disabled {
            cursor: not-allowed;
            opacity: 0.9;
        }
        .option.disabled:not(.selected):not(.correct-answer):hover {
            transform: none;
            background-color: var(--bg-light);
        }


        /* Navigation */
        #navigation-buttons {
            display: flex;
            justify-content: space-between; 
            align-items: center;
            margin-top: 30px;
            border-top: 1px solid var(--border-light);
            padding-top: 25px;
        }

        .nav-btn {
            background: var(--gradient-ocean);
            color: white;
            border: none;
            padding: 12px 28px;
            text-align: center;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 1rem;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            box-shadow: 0 8px 20px rgba(79, 209, 199, 0.3);
        }
        
        #prev-btn {
            background: var(--bg-white);
            color: var(--text-light);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--border-light);
        }
        #prev-btn:hover:not(:disabled) {
            background: #f9fafb;
            transform: translateY(-2px);
        }

        .nav-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 12px 25px rgba(79, 209, 199, 0.4);
        }

        .nav-btn:disabled {
            background: #e0e6ed;
            color: #9ca3af;
            cursor: not-allowed;
            box-shadow: none;
            opacity: 0.7;
        }
        
        #completion-message {
            text-align: center;
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--theme-purple);
            padding: 40px;
            animation: fadeInUp 0.5s ease-out;
        }
        #completion-message .final-score {
            font-size: 1.1rem;
            color: var(--text-dark);
            margin-top: 15px;
            font-weight: 400;
        }
        
        /* Responsive */
        @media (max-width: 600px) {
            body { padding: 10px; }
            .quiz-card { padding: 20px; }
            .question-text { font-size: 1.1rem; }
            .option { padding: 12px; }
            .nav-btn { padding: 10px 20px; font-size: 0.9rem; }
            #navigation-buttons { flex-direction: column-reverse; gap: 15px; }
            .nav-btn { width: 100%; justify-content: center; }
            #scoreboard { flex-direction: column; align-items: stretch; gap: 5px; }
            #scoreboard span { margin: 0; }
            .top-bar { padding: 0; }
            #set-navigation-container {
                display: flex;
                flex-direction: column;
                gap: 10px;
                align-items: stretch;
            }
            #set-selector { width: 100%; }
        }
    </style>
</head>
<body>
    <!-- Animated Symbols Background -->
    <div class="shape-container">
        <div class="shape shape1">₹</div>
        <div class="shape shape2">$</div>
        <div class="shape shape3">₹</div>
        <div class="shape shape4">€</div>
        <div class="shape shape5">₹</div>
        <div class="shape shape6">×</div>
    </div>

    <div class="quiz-wrapper">
        <div class="top-bar">
            <a href="index.html" class="home-btn"><i class="fas fa-arrow-left"></i> Back to Home</a>
        </div>

        <div id="set-navigation-container">
            <label for="set-selector"><i class="fas fa-layer-group"></i> Switch to Set:</label>
            <select id="set-selector"></select>
        </div>

        <div id="scoreboard-container" class="scoreboard-container">
            <div id="scoreboard">
                <span id="correct-count">Correct: 0</span>
                <span id="incorrect-count">Incorrect: 0</span>
                <span id="attempted-count">Attempted: 0</span>
                <span id="accuracy-rate">Accuracy: N/A</span>
            </div>
        </div>

        <div id="quiz-container" class="quiz-card">
            <!-- This container is new, for the animation -->
            <div id="question-content-wrapper">
                <div id="question-header">Loading quiz...</div>
                <div id="question-text"></div>
                <div class="options-container" id="options-container">
                    <!-- Options will be dynamically inserted here -->
                </div>
            </div>
            
            <div id="navigation-buttons">
                <button id="prev-btn" class="nav-btn"><i class="fas fa-chevron-left"></i> Previous</button>
                <button id="next-btn" class="nav-btn">Next <i class="fas fa-chevron-right"></i></button>
            </div>
            <div id="completion-message" style="display:none;">
                <!-- Completion message dynamically inserted -->
            </div>
        </div>
    </div>

    <script>
        /*
         * --- PASTE ALL YOUR QUESTIONS HERE ---
         * The code will automatically divide them into sets of 15.
         *
         * I've added the first 15 questions for you.
         */
        const questionsData = [
            { q: "1. Ind AS 113 stands for", o: ["Fair Value Measurement", "Consolidated Financial Statements", "Share Based payments", "Financial Instruments: Presentation"], c: "Fair Value Measurement" },
            { q: "2. Share-based Payment is delt with by", o: ["101", "102", "113", "108"], c: "102" },
            { q: "3. Ind AS shall be applied in: selecting and applying accounting policies, and accounting for changes in accounting policies, changes in accounting estimates and corrections of prior period errors.", o: ["12", "16", "8", "21"], c: "8" },
            { q: "4. A Ltd. Has a machine whose original cost was Rs.45,000. The accumulated depreciation on the machine is Rs.15,000. Similar machine has recently been sold in the same locality at Rs. 25,000 with selling expenses Rs.2,000. Management determined the entity specific present value of future cash flows of the machine as Rs. 28,000. Find Recoverable amount.", o: ["Rs.23,000", "Rs.28,000", "Rs.25,000", "None of these"], c: "Rs.28,000" },
            { q: "5. The major three approaches to valuation of shares are:", o: ["Income Approach", "Net Assets Approach", "Market Approach", "All of the above"], c: "All of the above" },
            { q: "6. The major bases of asset valuation for a going concern:", o: ["Book Value", "Net Replacement Value", "Net Realisable Value", "All of the above"], c: "All of the above" },
            { q: "7. The Income approach for Valuation of Shares includes the models/Techniques:", o: ["Discounted Cash Flow", "Dividend Discount Model", "Maintainable Profits Basis", "All of the above"], c: "All of the above" },
            { q: "8. Some of the methods of Goodwill Valuation are", o: ["Capitalisation method", "Super profits method", "Average Maintainable Profits method", "All of the above"], c: "All of the above" },
            { q: "9. The ways of determining the value of goodwill using the capitalisation approach", o: ["Capitalisation of Average Profits", "Capitalisation of Super Profits", "Both 1 and 2", "Capitalisation of Average Future maintainable profit"], c: "Both 1 and 2" },
            { q: "10. The of an item of property, plant and equipment shall be recognised as an asset if, and only if: (i) it is probable that associated with the item will flow to the entity; and (ii) the of the item can be measured reliably.", o: ["cost, future economic benefits, cost", "future economic benefits, cost, future economic benefits", "cost, cost, cost", "future economic benefits, future economic benefits. future economic benefits"], c: "cost, future economic benefits, cost" },
            { q: "11. Property Plant and Equipment (PPE) are initially recognized at", o: ["purchase price", "fair value", "cost", "future economic benefits"], c: "cost" },
            { q: "12. Ind AS 113 establishes a fair value hierarchy that categorises into three levels of the inputs to valuation techniques for measuring fair value. The hierarchies are", o: ["inputs are quoted prices (unadjusted) in active markets for identical assets or liabilities that the entity can access at the measurement date.", "inputs are inputs other than quoted prices included within Level 1 that are observable for the asset or liability, either directly or indirectly.", "inputs are unobservable inputs for the asset or liability.", "All of the above"], c: "All of the above" },
            { q: "13. As per Ind AS 113 three widely used valuation techniques are", o: ["market approach, cost approach and income approach", "market approach, cost approach and profit approach", "customer approach, cost approach and profit approach", "market approach, inventory approach and profit approach"], c: "market approach, cost approach and income approach" },
            { q: "14. Which of the following is/are objective/s of Ind AS 113?", o: ["To set up a framework for measurement of fair value", "To specify requirements of disclosure of fair value measurement.", "Both 1 and 2", "None of these"], c: "Both 1 and 2" },
            { q: "15. Changes in Accounting Estimates result from--", o: ["new information", "new developments", "they are not corrections of errors", "All of these"], c: "All of these" },
            { q: "16. Mohini Ltd has 3 Segments namely X, Y, Z. The Total assets of the Company are Rs. 10,00 Crores. Segment X has Rs. 2 crores, Segment Y has Rs. 3 Crores and Segment Z has Rs. 5 crores. The Accountant contends that all the three Segments are Reportable Segments. In this case", o: ["X & Y segments are Reportable Segments", "Y & Z segments are Reportable Segments", "Z segment is a Reportable Segment", "All segments are Reportable Segments"], c: "All segments are Reportable Segments" },
            { q: "17. If total external Revenue reported by Operating Segments constitutes of the Entity's Revenue, additional Operating Segments should be identified as Reportable Segments.", o: ["Less than 75%", "75% or less", "Less than 90%", "90% or less"], c: "Less than 75%" },
            { q: "18. The term 'Chief Operating Decision-Maker' (CODM) identifies a -", o: ["Function", "Designation", "Person", "Title"], c: "Function" },
            { q: "19. An Operating Segment is a component of an Entity that engages in business activities from which it -", o: ["May earn Revenues or incur Expenses", "May earn Revenues and incur Expenses", "Earns Revenues and incurs Expenses", "Earns Revenues or incurs Expenses"], c: "May earn Revenues and incur Expenses" },
            { q: "20. An Opening Segment is a component of an Entity that engage in business activities from which it -", o: ["May earn Revenues", "May incur Expenses", "Either of the above", "Both 1 and 2"], c: "Both 1 and 2" },
            { q: "21. Tax Depreciation is accelerated, i.e. Tax Depreciation is higher than Accounting Depreciation. The entity should recognize -", o: ["DTA", "DTL", "Both 1 and 2", "None of these"], c: "DTL" },
            { q: "22. An Entity recognize a Liability of Rs.100 for Gratuity and Leave Encashment Expenses by creating a Provision. For Tax purposes, such amount will not be deductible until the Entity pays the same. Tax Rate is 25%. The Entity should -", o: ["Recognise DTA Rs.100", "Recognise DTL Rs.100", "Recognize DTA Rs.25", "Recognize DTL Rs.25"], c: "Recognize DTA Rs.25" },
            { q: "23. Borrowing Costs directly attributable to of a Qualifying asset should be capitalized as part of the cost of that Asset.", o: ["Acquisition", "Construction", "Production", "All of these"], c: "All of these" },
            { q: "24. Hari Ltd has purchased a Ship during the year on deferred payments basis, payable over next 10 years. This ship is", o: ["Qualifying asset as per Ind AS 23", "Non Qualifying Asset as per Ind As 23", "Qualifying Asset as per Ind AS 29", "Non qualifying Asset as per Ind AS 29"], c: "Non Qualifying Asset as per Ind As 23" },
            { q: "25. are money held and assets and liabilities to be received or paid in fixed or determinable amounts of money.", o: ["Non Money Items", "Monetary Items", "Financial Items", "Current Items"], c: "Monetary Items" },
            { q: "26. The major three approaches to valuation of shares are:", o: ["Income Approach", "Net Assets Approach", "Market Approach", "All of these"], c: "All of these" },
            { q: "27. The ways of determining the value of goodwill using the capitalisation approach", o: ["Capitalisation of Average Profits", "Capitalisation of Super Profits", "Both 1 and 2", "Capitalisation of Average Future maintainable profit"], c: "Both 1 and 2" },
            { q: "28. The major bases of asset valuation for a going concern:", o: ["Book Value", "Net Replacement Value", "Net Realisable Value", "All of these"], c: "All of these" },
            { q: "29. Capital Employed is Rs.255 Lakhs; Annual average profits are Rs.57 Lakhs; Normal rate of return is 12%. The value of goodwill on the basis of Capitalization of super profits will be", o: ["Rs.220 Lakhs", "Rs.475 Lakhs", "Rs.6.84 Lakhs", "Rs.26.40 Lakhs"], c: "Rs.220 Lakhs" },
            { q: "30. A firm values goodwill under 'Capitalisation of Profits' method Average profit of the firm for past 4 years has been determined at Rs.1,00,000 (before tax). Capital employed in the business is Rs.4,80,000 and its normal rate of return is 12%. Tax rate is 28% on average. Value of Goodwill based on capitalisation of average profit will be:", o: ["Rs. 1,20,000", "Rs.6,00,000", "Rs.5,00,000", "Rs.4,80,000"], c: "Rs.1,20,000" },
            { q: "31. The Indian Accounting Standards relevant for recognition, measurement and disclosure of financial instruments are", o: ["Financial instruments: Presentation (Ind AS 32)", "Financial instruments: Disclosure (Ind AS 107)", "Financial instruments: (Ind AS 109)", "All of these"], c: "All of these" },
            { q: "32. An is any contract that evidences a residual interest in the assets of an entity after deducting all of its liabilities.", o: ["Equity instrument", "Puttable instrument", "Financial instrument", "None of the above"], c: "Equity instrument" },
            { q: "33. Ind As 109 deals with", o: ["Recognition and measurement of financial instruments and hedge accounting", "Presentation of financial instruments", "Disclosure of financial instruments", "None of the above"], c: "Recognition and measurement of financial instruments and hedge accounting" },
            { q: "34. Non-Performing Asset (NPA) in case of Lease Rental and Hire- Purchase Assets if", o: ["Overdue for 9 Months as on 31st March 2016", "Overdue for 6 Months as on 31st March 2017", "Overdue for 3 Months as on 31st March 2018 and Onwards", "All of these"], c: "All of these" },
            { q: "35. The term 'Public Funds' includes", o: ["Debentures", "Funds raised directly or indirectly through public deposits", "Bank Finance", "All of these"], c: "All of these" },
            { q: "36. IND AS is applicable to NBFCs on and from", o: ["1.4.2016", "1.4.2017", "1.4.2015", "1.4.2018"], c: "1.4.2018" },
            { q: "37. All NBFCs-ND which have an asset size of Rs.500 crore and above and all NBFCs-D shall maintain minimum Tier 1 Capital of", o: ["12%", "15%", "10%", "1%"], c: "10%" },
            { q: "38. From the following particulars you are required to determine value of goodwill of ABX Ltd. Super Profit (Computed): Rs. 4,50,000 Normal rate of return 12% Present value of annuity of Rs.1 for 4 years @ 12%: 3.0374", o: ["Rs.13,66,830", "Rs.4,50,000", "", ""], c: "Rs.13,66,830" },
            { q: "39. Super Profit Average Future Maintainable Profit -", o: ["Normal Profit", "Estimaded Profit", "Future Maintainable Profit", "Average Capital Employed"], c: "Normal Profit" },
            { q: "40. The major bases of asset valuation for a going concern", o: ["Book Value", "Net Replacement Value", "Net Realisable Value", "All of these"], c: "All of these" },
            { q: "41. X Ltd. granted a loan to Y Ltd. amounting to Rs.40 lakhs repayable in 2 years at Rs.46 lakhs. However, due to economic recession after 1 year the repayable amount has been revised at Rs.44 lakhs. Effective annual interest rate for such a loan is determined at 6% p.a. The loan processing cost was Rs.2 lakhs. X Ltd's accountant suggested to compute the amount to be charged as processing cost to the first year in the Profit and Loss A/c. Compute.", o: ["Rs.40 Lakhs", "Rs.2 Lakhs", "Rs. 42 Lakhs", "None of these"], c: "None of these" },
            { q: "42. The Indian Accounting Standards relevant for recognition, measurement and disclosure of financial instruments are", o: ["Financial instruments: Presentation (Ind AS 32)", "Financial instruments: Disclosure (Ind AS 107)", "Financial instruments: (Ind AS 109)", "All of these"], c: "All of these" },
            { q: "43. Financial assets are", o: ["cash", "an equity instrument of another entity", "a contractual right", "All of these"], c: "All of these" },
            { q: "44. Ind AS 109: Financial Instruments classifies the financial assets and financial liabilities into the following categories for recognition and measurement", o: ["Measured at fair value thought OCI", "Measured at amortized cost", "Measured at fair value through P & L", "All of these"], c: "All of these" },
            { q: "45. Ind As 109 deals with", o: ["recognition and measurement of financial instruments and hedge accounting", "presentation of financial instruments", "disclosure of financial instruments", "None of these"], c: "recognition and measurement of financial instruments and hedge accounting" },
            { q: "46. An is any contract that evidences a residual interest in the assets of an entity after deducting all of its liabilities.", o: ["equity instrument", "puttable instrument", "financial instrument", "None of these"], c: "equity instrument" },
            { q: "47. Fair value is the amount for which an asset could be exchanged, or a liability settled, between knowledgeable, willing parties in an", o: ["fair transaction", "influenced transaction", "arm's length transaction", "All of these"], c: "arm's length transaction" },
            { q: "48. A Ltd. acquires 80% of B Ltd. for Rs. 12,80,000 paid by equity at par. Fair Value (FV) of B's net assets at time of acquisition amounts Rs. 9,00,000. NCI is measured at proportionate net asset. The value of goodwill will be:", o: ["Rs. 3,00,000", "Rs.3,80,000", "Rs.4,50,000", "Rs.5,60,000"], c: "Rs.5,60,000" },
            { q: "49. A Ltd. acquires 80% of B Ltd. for Rs. 10,00,000 paid by equity at par. Fair Value (FV) of B's net assets at time of acquisition amounts Rs.9,00,000. The value of goodwill based on NCI valued at proportionate fair value of identified net asset will be:", o: ["Rs.3,00,000", "Rs.2,80,000", "Rs.4.50,000", "Rs.5,00,000"], c: "Rs.2,80,000" },
            { q: "50. On 1 January 2023 A Ltd. acquires 80 per cent of the equity interests of B Ltd in exchange of cash of Rs.600 lakhs. The identifiable assets are measured at Rs. 925 lakh and the liabilities assumed are measured at Rs.150 lakh. The fair value of the 20 per cent non-controlling interest in P is Rs.90 lakhs. The gain on bargain purchase will be -", o: ["Rs.90 Lakhs", "Rs.85 Lakhs", "Rs. 105 Lakhs", "Rs.75 Lakhs"], c: "Rs.85 Lakhs" },
            { q: "51. A Ltd. takes over B Ltd. for Rs. 12,60,000. Fair Value (FV) of B's net assets at time of acquisition amounts Rs. 11,80,000. Calculate Goodwill.", o: ["Rs. 12,60,000", "Rs.80,000", "Rs. 11,80,000", "None of these"], c: "Rs.80,000" },
            { q: "52. Q Ltd. acquired a 60% interest in R Ltd. on January 1, 2023. Q Ltd. paid Rs. 900 Lakhs in cash for their interest in R Ltd. The fair value of R Ltd.'s assets is Rs. 2,000 Lakhs, and the fair value of its liabilities is Rs. 1,000 Lakhs. If NCI is valued at proportionate net asset, value of Goodwill:", o: ["Rs. 300 Lakhs", "Rs.250 Lakhs", "Rs.400 Lakhs", "Rs. 350 Lakhs"], c: "Rs. 300 Lakhs" },
            { q: "53. On March 31, 201X, A Ltd absorbed B Ltd. A Ltd. issued 60,000 equity shares (Rs.10 par value) that were trading at Rs.25 on March 31. The book value of B's net assets was Rs. 12,00,000, Equity Share Capital Rs.5,00,000 and Other Equity Rs.7,00,000 on March 31. The fair value of net assets of B Ltd. was assessed at Rs.13,00,000.", o: ["Rs.2,00,000", "Rs.15,00,000", "Rs.6,00,000", "None of these"], c: "Rs.2,00,000" },
            { q: "54. As per Ind AS 103, while accounting and reporting for business combination goodwill is calculated as", o: ["Consideration + Non controlling Interest Net assets", "Consideration Non controlling Interest + Net assets", "Consideration - Non controlling Interest - Net assets", "Consideration + Non controlling Interest + Net assets"], c: "Consideration + Non controlling Interest - Net assets" },
            { q: "55. On 01.04.2020 Gold Ltd. acquired 75% share of Coal Ltd. at Rs.10,80,000, when the fair value of its net assets was Rs.10,00,000. During 01.4.2022 to 31.3.2023 Coal Ltd. made TCI Rs. 2,00,000. On 31.3.2023 Gold Ltd. purchased 15% holding from outsiders at Rs.2,20,000. Compute NCI at Proportionate net asset value.", o: ["Rs.1,80,000", "Rs.1,92,000", "Rs.2,46,000", "Rs.2,20,000"], c: "Rs.1,80,000" },
            { q: "56. On 01.04.2020 Gold Ltd. acquired 75% share of Coal Ltd. at Rs.10,80,000, when the fair value of its net assets was 1000000. During 01.4.2022 to 31.3.2023 Coal Ltd made TCI Rs. 2,00,000. Оп 31.3.2023 Gold Ltd. purchased 15% holding from outsiders at Rs.2,20,000. Compute gain/loss credited/debited to Other Equity.", o: ["Loss of Rs.40,000", "Gain of Rs.40,000", "Loss of Rs.28,000", "Gain of Rs.28.000"], c: "Loss of Rs.40,000" },
            { q: "57. D Ltd. has acquired 100% of the equity of F Ltd. on March 31, 2023. The purchase consideration comprises of an immediate payment of Rs. 10 lakhs and two further payments of Rs.1.21 lakhs if the Return on Equity exceeds 20% in each of the subsequent two financial years. A discount rate of 10% is used. Compute the value of total consideration at the acquisition date.", o: ["Rs.10 lakhs", "Rs.2.10 Lakhs", "Rs.12.10 Lakhs", "None of these"], c: "Rs.12.10 Lakhs" },
            { q: "58. Entity A acquired 35% of Entity B on 01.04.2023 for Rs. 35,000. On 31.03.2024, fair value of shares of Entity B is Rs. 42,000, thus Rs.7,000 reported under OCI in 2023-24. On 01.07.2020 Entity A further acquired 40% stake in Entity B. Consideration paid is Rs. 60,000. Entity A identifies the net assets of Entity B at fair value of Rs. 1,20,000 at the acquisition date, value 35% shares at Rs. 45,000. NCI is valued at proportionate net assets. Compute the total amount to be transferred to P&L A/c of Entity A.", o: ["Rs.3,000", "Rs.10,000", "Rs.7,000", "Rs.45,000"], c: "Rs.10,000" },
            { q: "59. On 1 January 2023 M Ltd. acquires 80 per cent of the equity interests of P Ltd. by issue of equity shares of paid-up value of Rs.200 Lakhs (market value Rs.480 Lakhs). The identifiable assets are measured at Rs.760 Lakhs and the liabilities assumed are measured at Rs.120 Lakhs. Compute Non-controlling Interest if measured at proportionate net asset value.", o: ["Rs.640 Lakhs", "Rs.760 Lakhs", "Rs.128 Lakhs", "Rs.480"], c: "Rs.128 Lakhs" },
            { q: "60. On 1 January 2023 P Ltd. acquires 80 per cent of the equity interests of Q Ltd. by issue of equity shares of paid-up value of Rs.50 Lakhs (market value Rs. 120 Lakhs). The identifiable assets are measured at Rs.190 Lakhs and the liabilities assumed are measured at Rs.30 Lakhs. Non-controlling Interest is measured at proportionate net asset value. Compute the amount of Gain on Bargain Purchase.", o: ["Rs.8 Lakhs", "Rs.160 Lakhs", "Rs. 190 Lakhs", "Rs.32 Lakhs"], c: "Rs.8 Lakhs" },
            { q: "61. A Ltd. acquires 80% shares of B Ltd. for Rs. 12,80,000. Fair Value (FV) of B Ltd.'s net assets at time of acquisition amounts Rs.14,80,000. Non-Controlling Interests are recognized at fair value. Compute Non-Controlling Interests.", o: ["Rs. 12,80,000", "Rs.3,20,000", "Rs.2,56,000", "Rs.10,24,000"], c: "Rs.3,20,000" },
            { q: "62. The pooling of interest method is considered to involve which the following?", o: ["The assets and liabilities of the combining entities are reflected at their carrying amounts", "The assets and liabilities of the combining entities are reflected at their Net realisable value", "No adjustments are made to reflect fair values, or recognize any new assets or liabilities", "Both 1 and 3"], c: "Both 1 and 3" },
            { q: "63. How is non-controlling interest shown in the financial statements of the acquirer at the time of a business combination under Ind AS 103?", o: ["It is shown as a liability", "It is shown as an item under equity", "It is not shown in balance sheet", "Non-controlling interest is not recognised."], c: "It is shown as an item under equity" },
            { q: "64. As per Ind AS 103 , accounting and reporting for business combination is done under", o: ["Acquisition Method", "Purchase method", "Pooling of interest method", "None of these"], c: "Acquisition Method" },
            { q: "65. When after business combination, acquiree ceases to exist, it is to be recorded in the books of the in one set only, in its stand-alone accounts.", o: ["acquirer", "acquiree", "both 1 and 2", "either 1 or 2"], c: "acquirer" },
            { q: "66. Ind AS 103 has a wider scope than", o: ["AS 15", "AS 14", "AS 16", "AS 13"], c: "AS 14" },
            { q: "67. At what value is non-controlling interest recorded in the books of the Acquiree at the time of a business combination transaction under Ind AS 103?", o: ["It is recognised at fair value only", "It is recognised at proportionate fair value of identified net assets only", "It is not recognised at all", "It is recognised either at fair value or at proportionate fair value of identified net assets."], c: "It is recognised either at fair value or at proportionate fair value of identified net assets." },
            { q: "68. Consolidated financial statements are required to be prepared by an Ind AS complied company if it holds shares in the investee company", o: ["entailing 20% or more voting rights having significant influence over the investee company (called Associate as per Ind AS 28)", "entailing joint control over the investee company (called a Joint Venture as per Ind AS 28)", "entailing control over investee company (called subsidiary company as per Ind AS 110)", "All of these"], c: "All of these" },
            { q: "69. requires that when consolidated financial statements are prepared the investor company shall also prepare individual/standalone financial statements, which are named as separate financial statements", o: ["Ind AS 27", "Ind AS 28", "Ind AS 110", "Ind AS 112"], c: "Ind AS 27" },
            { q: "70. An investment entity is an entity that", o: ["obtains funds from one or more investors for the purpose of providing those investor(s) with investment management services", "commits to its investor(s) that its business purpose is to invest funds solely for returns from capital appreciation, investment income, or both", "measures and evaluates the performance of substantially all of its investments on a fair value basis", "All of these"], c: "All of these" },
            { q: "71. Ind AS 103 states that the acquirer obtaining control over acquiree, recognises and measures in its consolidated financial statements at the acquisition date", o: ["the identifiable assets acquired, the liabilities assumed at Fair Value", "any non-controlling interest in the acquiree at Fair Value or at Proportionate Value", "the goodwill acquired in the business combination or a gain on bargain purchase", "All of these"], c: "All of these" },
            { q: "72. As per Ind AS 112: Disclosure of Interests in Other Entities, an entity shall disclose information about significant judgements and assumptions it has made (and changes to those judgements and assumptions) in determining", o: ["that it has control of another entity, i.e. an investee as described in paragraphs 5 and 6 of Ind AS 110, Consolidated Financial Statements", "that it has joint control of an arrangement or significant influence over another entity", "the type of joint arrangement (i.e. joint operation or joint venture) when the arrangement has been structured through a separate vehicle", "All of these"], c: "All of these" },
            { q: "73. is the contractually agreed sharing of control of an arrangement, which exists only when decisions about the relevant activities require the unanimous consent of the parties sharing control", o: ["Joint Control", "Joint Arrangement", "Joint Operation", "None of these"], c: "Joint Control" },
            { q: "74. A joint arrangement is either a or a joint venture", o: ["joint operation", "joint control", "joint partnership", "None of these"], c: "joint operation" },
            { q: "75. is a method of accounting whereby the investment is initially recognised at cost and adjusted thereafter for the post- acquisition change in the investors share of the investees net assets.", o: ["equity method", "pooling interest method", "purchase method", "None of these"], c: "equity method" },
            { q: "76. Which of the following is not a type of joint arrangement recognised under Ind AS 111?", o: ["Joint Venture", "Joint Operation", "Joint Control Entity", "Joint Contribution Entity"], c: "Joint Contribution Entity" },
            { q: "77. How is the investor's share of profit or loss from a joint venture recognised?", o: ["As a revenue", "As a liabilities", "As an expense", "As a part of equity"], c: "As a part of equity" },
            { q: "78. An is an entity over which the investor has significant influence.", o: ["Associate", "Joint Venture", "Partnership", "All of these"], c: "Associate" },
            { q: "79. The three pillars of sustainability are often referred to as", o: ["Planet-People - Profit", "People Planet - Profit", "People-Profit - Planet", "People-Plant- Profit"], c: "People Planet - Profit" },
            { q: "80. A company required to furnish cost audit report and other documents to the Central Government under Section 148(6) of the Companies Act, 2013 and rules made thereunder, shall file such report and other documents using the XBRL taxonomy given in Annexure-III to the said Rule for the financial years on or after April 1, 2014 in e-Form specified under the Companies (Cost Records and Audit) Rules, 2014", o: ["CRA-2", "CRA-3", "CRA-4", "CRA-1"], c: "CRA-4" },
            { q: "81. External benefits of sustainability reporting can include", o: ["Mitigating - or reversing-negative environmental, social and governance impacts", "Improving reputation and brand loyalty", "Enhanced perception on organisation's value", "All of the above"], c: "All of the above" },
            { q: "82. In 4P Bottom Line Reporting bottom line relate business with happiness of stakeholders", o: ["first", "second", "third", "forth"], c: "forth" },
            { q: "83. The key challenges for implementation of QBL reporting framework are", o: ["Awareness of relevant issues associated with QBL reporting", "Understanding stakeholder requirements", "Aligning QBL reporting with objectives and risks", "All of these"], c: "All of these" },
            { q: "84. External benefits of sustainability reporting can include", o: ["Enhanced link. between financial and non-financial performance", "Improving reputation and brand loyalty", "Enhanced perception on organisation's value", "Both 2 and 3"], c: "Both 2 and 3" },
            { q: "85. Which of the following is/are benefit/s of XBRL Reporting?", o: ["Automated Data Processing", "Improved reporting quality", "Cost and time savings", "All of these"], c: "All of these" },
            { q: "86. XBRL stands for", o: ["eXtended Business Reporting Language", "eXtensible Business Reporting Language", "eXtensible Business Reporting Laws", "eXtended Business Reported Language"], c: "eXtensible Business Reporting Language" },
            { q: "87. EVA=", o: ["NOPAT - (WACC Invested Capital)", "PAT - (WACC Invested Capital)", "EBIT - (WACC Invested Capital)", "None of these"], c: "NOPAT - (WACC Invested Capital)" },
            { q: "88. report is an analytical tool for displaying human resources-related facts, insights, and metrics to improve workforce performance, recruiting procedures, and other important HR operations.", o: ["Environmental, Social and Governance", "Corporate Social Responsibility", "Human Resources", "Integrated"], c: "Human Resources" },
            { q: "89. Corporate sustainability reporting helps companies to", o: ["assess and manage their sustainability impacts", "report their contributions to sustainable development", "integrate sustainability into their business strategies", "All of these"], c: "All of these" },
            { q: "90. Which of the following is not a feature of Government Accounting?", o: ["Non-fund based Accounting", "Double Entry System", "Adherence to Government Regulations", "Transacting through Banks"], c: "Non-fund based Accounting" },
            { q: "91. GASAB stands for", o: ["Government Accounting Standards Advisory Board", "Government Accounting Standards Applicability Board", "Government Auditing Standards Advisory Board", "Government Accounting for States Advisory Board"], c: "Government Accounting Standards Advisory Board" },
            { q: "92. IGAS 2 is related to", o: ["Accounting and Classification of Grants-in-aid", "Guarantees given by Governments: Disclosure Requirements", "Government Investments in Equity", "None of the above"], c: "Guarantees given by Governments: Disclosure Requirements" },
            { q: "93. Which of the following is not a general principal of Government Accounting?", o: ["Reporting of Utilisation of Public Funds", "Expenditures are classified under Sectors, major heads, minor heads, sub-heads and detailed heads of Accounts", "Budget Based", "Single Entry System"], c: "Single Entry System" },
            { q: "94. Standards developed for accrual system of accounting in the Government are called the", o: ["Indian Government Accounting Standards", "Indian Government Reporting Standards", "Indian Government Financial Reporting Standards", "Indian Government Accounting and Reporting Standards"], c: "Indian Government Financial Reporting Standards" },
            { q: "95. Which of the following is/are responsibility/responsibilities of GASAB?", o: ["Formulating and proposing standards that improve the usefulness of financial reports", "Keeping the standards up to date and reflect change in the Governmental environment", "Improving standard of Government accounting and financial reporting", "All of the above"], c: "All of the above" },
            { q: "96. As per The Constitution of India, the Accounts of the Government are kept in", o: ["Consolidated Funds of India", "Public Accounts of India", "Contingency Funds of India", "All of the above"], c: "All of the above" },
            { q: "97. The financial statements of the Union Government, State Governments and the Union Territories with legislature shall disclose the following details concerning Public Debt and other obligations", o: ["the opening balance, additions and discharges during the year, closing balance and net change in rupee terms with respect to internal debt", "the opening balance, additions and discharges during the year, closing balance and net change in rupee terms with respect to external debt, wherever applicable", "the opening balance, receipts and disbursements during the year, closing balance and net change in rupee terms with respect of other obligations", "All of the above"], c: "All of the above" },
            { q: "98. Consolidated Fund of India is the fund referred to in of the Constitution of India", o: ["Article 266(1)", "Article 266(2)", "Article 266(3)", "Article 266(4)"], c: "Article 266(1)" },
            { q: "99. The Financial Statements of the Union Government shall disclose the following details under 'Loans and Advances made by the Union Government' in the Annual Finance Accounts of the Union Government", o: ["the summary of Loans and Advances showing loanee group- wise details", "the summary of Loans and Advances showing Sector-wise details", "the summary of repayments in arrears from Governments and other loanee entities", "All of the above"], c: "All of the above" }
        ];
        // --- END OF QUESTION DATA ---


        let currentQuestionIndex = 0;
        let userAnswers = new Array(questionsData.length).fill(null); 
        let questionsAttemptedState = new Array(questionsData.length).fill(false); 

        let score = {
            correct: 0,
            incorrect: 0
        };

        // --- Set Configuration ---
        const totalQuestions = questionsData.length;
        const setSize = 15; // 15 questions per set
        const numSets = Math.ceil(totalQuestions / setSize);
        const questionsPerSet = [];
        const setStartIndices = [];

        for(let i = 0; i < numSets; i++) {
            setStartIndices.push(i * setSize);
            const size = Math.min(setSize, totalQuestions - (i * setSize));
            questionsPerSet.push(size);
        }
        // --- End Set Configuration ---


        // DOM Elements
        const questionHeaderElement = document.getElementById('question-header');
        const questionTextElement = document.getElementById('question-text');
        const optionsContainerElement = document.getElementById('options-container');
        const nextButton = document.getElementById('next-btn');
        const prevButton = document.getElementById('prev-btn');
        const completionMessageElement = document.getElementById('completion-message');
        const setSelectorElement = document.getElementById('set-selector');
        const navigationButtons = document.getElementById('navigation-buttons'); 
        const quizContainer = document.getElementById('quiz-container');
        const questionContentWrapper = document.getElementById('question-content-wrapper');


        const correctCountElement = document.getElementById('correct-count');
        const incorrectCountElement = document.getElementById('incorrect-count');
        const attemptedCountElement = document.getElementById('attempted-count');
        const accuracyRateElement = document.getElementById('accuracy-rate');
        
        function populateSetSelector() {
            setSelectorElement.innerHTML = ''; 
            questionsPerSet.forEach((num, index) => {
                if (num === 0) return;
                
                const option = document.createElement('option');
                option.value = index; 
                const startQ = setStartIndices[index] + 1;
                const endQ = setStartIndices[index] + num;
                
                option.textContent = `Set ${index + 1} (Q ${startQ} - ${endQ})`;
                setSelectorElement.appendChild(option);
            });
            setSelectorElement.addEventListener('change', (event) => {
                const selectedSetIndex = parseInt(event.target.value);
                currentQuestionIndex = setStartIndices[selectedSetIndex];
                
                // Reset visibility for quiz
                completionMessageElement.style.display = 'none';
                questionContentWrapper.style.display = 'block';
                navigationButtons.style.display = 'flex'; 
                
                loadQuestion(false); // Load question without animation for set switch
            });
        }

        function getCurrentSetInfo(index) {
            for (let i = 0; i < setStartIndices.length; i++) {
                const setStartIndex = setStartIndices[i];
                const setEndIndex = setStartIndex + questionsPerSet[i] - 1;
                
                if (index >= setStartIndex && index <= setEndIndex) {
                    // Update dropdown silently if needed
                    if (setSelectorElement.value != i) { 
                         setSelectorElement.value = i; 
                    }
                    return { setNumber: i + 1, totalSets: numSets };
                }
            }
            return { setNumber: numSets, totalSets: numSets }; // Fallback
        }
        
        function updateScoreboard() {
            score.correct = 0;
            score.incorrect = 0;
            let attempted = 0;

            for (let i = 0; i < totalQuestions; i++) {
                if (questionsAttemptedState[i]) {
                    attempted++;
                    const currentQuestion = questionsData[i];
                    // Correct answer is stored as text in 'c'
                    const correctAnswerText = currentQuestion.c; 
                    if (userAnswers[i] === correctAnswerText) {
                        score.correct++;
                    } else {
                        score.incorrect++;
                    }
                }
            }
            
            correctCountElement.textContent = `Correct: ${score.correct}`;
            incorrectCountElement.textContent = `Incorrect: ${score.incorrect}`;
            attemptedCountElement.textContent = `Attempted: ${attempted}`;
            if (attempted > 0) {
                const accuracy = (score.correct / attempted * 100).toFixed(1);
                accuracyRateElement.textContent = `Accuracy: ${accuracy}%`;
            } else {
                accuracyRateElement.textContent = `Accuracy: N/A`;
            }
        }

        function loadQuestion(animate = true) {
            if (currentQuestionIndex < 0) currentQuestionIndex = 0; 
            if (currentQuestionIndex >= totalQuestions) { 
                showCompletionMessage();
                return;
            }

            // --- Animation ---
            if (animate) {
                questionContentWrapper.classList.remove('animate-slideInRight');
                // Trigger reflow to restart animation
                void questionContentWrapper.offsetWidth; 
                questionContentWrapper.classList.add('animate-slideInRight');
            }
            // --- End Animation ---


            const currentQuestion = questionsData[currentQuestionIndex];
            const setInfo = getCurrentSetInfo(currentQuestionIndex);
            
            // Correct answer is stored as text in 'c'
            const correctAnswerText = currentQuestion.c; 

            questionHeaderElement.innerHTML = `<strong>Question ${currentQuestionIndex + 1}</strong> of ${totalQuestions} (<strong>Set ${setInfo.setNumber}</strong> of ${setInfo.totalSets})`;
            
            // Question text already has numbers, so just use it
            let qText = currentQuestion.q;
            qText = qText.replace(/____/g, '<span class="blank-span"></span>');
            questionTextElement.innerHTML = qText;

            optionsContainerElement.innerHTML = ''; 
            currentQuestion.o.forEach((optionText, index) => {
                const optionElement = document.createElement('div');
                optionElement.classList.add('option');
                optionElement.dataset.optionText = optionText; 
                
                const optionLetter = String.fromCharCode(65 + index); 
                // No cleanText needed for this file
                optionElement.innerHTML = `<span class="option-letter">${optionLetter}</span> <span class="option-text">${optionText}</span>`;
                
                if (questionsAttemptedState[currentQuestionIndex]) { 
                    optionElement.classList.add('disabled');
                    if (optionText === userAnswers[currentQuestionIndex]) {
                        optionElement.classList.add('selected');
                        if (userAnswers[currentQuestionIndex] === correctAnswerText) {
                            optionElement.classList.add('correct-answer');
                        } else {
                            optionElement.classList.add('incorrect-selection');
                        }
                    }
                    if (optionText === correctAnswerText) { 
                         optionElement.classList.add('correct-answer'); 
                    }
                } else {
                    optionElement.addEventListener('click', () => handleOptionSelection(optionElement, optionText));
                }
                optionsContainerElement.appendChild(optionElement);
            });

            // Update button text and icons
            if (currentQuestionIndex === totalQuestions - 1) {
                nextButton.innerHTML = 'Finish Quiz <i class="fas fa-check"></i>';
            } else {
                nextButton.innerHTML = 'Next <i class="fas fa-chevron-right"></i>';
            }
            nextButton.disabled = false; 
            prevButton.disabled = (currentQuestionIndex === 0);

            // Ensure quiz container is visible
            questionContentWrapper.style.display = 'block';
            navigationButtons.style.display = 'flex';
            completionMessageElement.style.display = 'none';
        }

        function handleOptionSelection(selectedDiv, selectedOptionText) {
            if (questionsAttemptedState[currentQuestionIndex]) return; 

            questionsAttemptedState[currentQuestionIndex] = true;
            userAnswers[currentQuestionIndex] = selectedOptionText;

            const currentQuestion = questionsData[currentQuestionIndex];
            // Correct answer is stored as text in 'c'
            const correctAnswerText = currentQuestion.c; 

            Array.from(optionsContainerElement.children).forEach(optDiv => {
                optDiv.classList.add('disabled'); 
                if (optDiv.dataset.optionText === correctAnswerText) { 
                    optDiv.classList.add('correct-answer');
                }
                if (optDiv === selectedDiv) { 
                    optDiv.classList.add('selected');
                    if (selectedOptionText !== correctAnswerText) {
                        optDiv.classList.add('incorrect-selection'); 
                    }
                }
            });
            updateScoreboard();
        }
        
        function selectOptionByKey(key) {
            if (questionsAttemptedState[currentQuestionIndex]) return;

            let optionIndex = -1;
            if (key === 'a' || key === '1') optionIndex = 0;
            else if (key === 'b' || key === '2') optionIndex = 1;
            else if (key === 'c' || key === '3') optionIndex = 2;
            else if (key === 'd' || key === '4') optionIndex = 3;

            if (optionIndex !== -1 && optionIndex < optionsContainerElement.children.length) {
                const optionDiv = optionsContainerElement.children[optionIndex];
                if (optionDiv && !optionDiv.classList.contains('disabled')) {
                    handleOptionSelection(optionDiv, optionDiv.dataset.optionText);
                }
            }
        }

        function nextQuestionHandler() {
            if (currentQuestionIndex === totalQuestions - 1) {
                currentQuestionIndex++; 
                showCompletionMessage();
            } 
            else if (currentQuestionIndex < totalQuestions - 1) {
                currentQuestionIndex++;
                loadQuestion(true); // Animate to next question
            }
        }

        function prevQuestionHandler() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                loadQuestion(false); // No animation for previous question
            }
        }
        
        function showCompletionMessage() {
            // Hide quiz elements
            questionContentWrapper.style.display = 'none';
            navigationButtons.style.display = 'none'; 
            
            // Show completion message
            completionMessageElement.style.display = 'block';
            const attempted = score.correct + score.incorrect;
            const accuracy = attempted > 0 ? (score.correct / attempted * 100).toFixed(1) : "0.0";
            
            completionMessageElement.innerHTML = `Quiz Completed!
                <div class="final-score">
                    Final Score: ${score.correct} Correct, ${score.incorrect} Incorrect
                    <br>
                    Accuracy: ${accuracy}%
                </div>`;
            
            // Scroll to top to see message
            quizContainer.scrollIntoView({ behavior: 'smooth' });
            createConfetti(); // Trigger confetti!
        }

        // --- Visual Effects Functions ---

        // 1. Particle Click Effect
        function createParticles(x, y) {
            const colors = ['var(--theme-purple)', 'var(--theme-blue)', 'var(--theme-pink)', 'var(--theme-yellow)', 'var(--theme-cyan)'];
            for (let i = 0; i < 10; i++) { // Increased particle count for more "pop"
                const particle = document.createElement('div');
                particle.style.position = 'fixed';
                particle.style.left = x + 'px';
                particle.style.top = y + 'px';
                particle.style.width = (Math.random() * 5 + 3) + 'px'; // Random size
                particle.style.height = particle.style.width;
                particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                particle.style.borderRadius = '50%';
                particle.style.pointerEvents = 'none';
                particle.style.zIndex = '9999';
                particle.style.opacity = '1';
                
                document.body.appendChild(particle);
                
                const angle = Math.random() * Math.PI * 2;
                const velocity = Math.random() * 4 + 2;
                const dx = Math.cos(angle) * velocity;
                const dy = Math.sin(angle) * velocity;
                let opacity = 1;
                
                const animate = (timestamp) => {
                    particle.style.transform = `translate(${dx * (1 - opacity) * 10}px, ${dy * (1 - opacity) * 10}px) scale(${opacity})`;
                    opacity -= 0.03; // Fade faster
                    
                    if (opacity > 0) {
                        requestAnimationFrame(animate);
                    } else {
                        particle.remove();
                    }
                };
                requestAnimationFrame(animate);
            }
        }
        
        // 2. Confetti Effect
        function createConfetti() {
            const colors = ['var(--theme-purple)', 'var(--theme-blue)', 'var(--theme-pink)', 'var(--theme-yellow)', 'var(--theme-cyan)'];
            for (let i = 0; i < 100; i++) { // 100 particles for a good celebration
                const particle = document.createElement('div');
                particle.classList.add('confetti-particle');
                particle.style.left = (Math.random() * 100) + 'vw';
                particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                particle.style.animationDelay = (Math.random() * 2) + 's'; // Stagger the fall
                particle.style.width = (Math.random() * 8 + 5) + 'px';
                particle.style.height = particle.style.width;
                if(i % 2 === 0) {
                    particle.style.borderRadius = '0'; // Make some square
                    particle.style.height = (Math.random() * 5 + 5) + 'px';
                }
                document.body.appendChild(particle);

                // Remove particle after animation ends
                setTimeout(() => {
                    particle.remove();
                }, 3000);
            }
        }


        // --- Event Listeners for Navigation/Interaction ---
        nextButton.addEventListener('click', nextQuestionHandler);
        prevButton.addEventListener('click', prevQuestionHandler);
        
        // Add particle click listener
        document.addEventListener('click', function(e) {
            // Don't trigger on scrollbar
            if (e.clientX < document.documentElement.clientWidth && e.clientY < document.documentElement.clientHeight) {
                createParticles(e.clientX, e.clientY);
            }
        });


        document.addEventListener('keydown', (event) => {
            // Prevent shortcuts while dropdown is focused
            if (document.activeElement === setSelectorElement) return;

            if (event.key.toLowerCase() === 'escape') return; 

            if (completionMessageElement.style.display === 'block') { 
                 event.preventDefault(); 
                 return;
            }

            const key = event.key.toLowerCase();
            if (['a', 'b', 'c', 'd', '1', '2', '3', '4'].includes(key)) {
                event.preventDefault();
                selectOptionByKey(key);
            } else if ((key === 'enter' || key === 'arrowright' || key === ' ') && !nextButton.disabled) { 
                event.preventDefault();
                nextQuestionHandler();
            } else if ((key === '/' || key === 'arrowleft') && !prevButton.disabled) { 
                event.preventDefault();
                prevQuestionHandler();
            }
        });

        // --- Initial setup ---
        populateSetSelector();
        loadQuestion(false); // Load first question without animation
        updateScoreboard(); 
    </script>
</body>
</html>
